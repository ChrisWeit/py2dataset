
        <html>
        <head>
            <style>
                table {border-collapse: collapse; width: 100%; table-layout: fixed;}
                th, td {
                    border: 1px solid black;
                    padding: 8px;
                    text-align: left;
                    white-space: pre-line;
                    vertical-align: top;
                    word-wrap: break-word;
                }
            </style>
        </head>
        <body>
            <table>
                <thead>
                    <tr>
        <th style='width: 33.333333333333336%;'>instruction</th><th style='width: 33.333333333333336%;'>input</th><th style='width: 33.333333333333336%;'>output</th>
                    </tr>
                </thead>
                <tbody>
        <tr><td>What&nbsp;are&nbsp;the&nbsp;dependencies&nbsp;of&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>&quot;&quot;&quot;<br/>Utility&nbsp;functions&nbsp;for&nbsp;reading&nbsp;the&nbsp;input&nbsp;and&nbsp;saving&nbsp;the&nbsp;output&nbsp;of&nbsp;the&nbsp;py2dataset&nbsp;script.<br/>Requirements:<br/>[req01]&nbsp;The&nbsp;`read_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Read&nbsp;and&nbsp;return&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>[req02]&nbsp;The&nbsp;`write_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;dictionary&nbsp;and&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Write&nbsp;the&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;file&nbsp;in&nbsp;either&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;format.<br/>[req03]&nbsp;The&nbsp;`convert_json_to_html`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;each&nbsp;converted&nbsp;file&nbsp;with&nbsp;a&nbsp;.html&nbsp;extension.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Preserve&nbsp;spacing&nbsp;and&nbsp;tabs&nbsp;for&nbsp;the&nbsp;&#x27;input&#x27;&nbsp;field.<br/>[req04]&nbsp;The&nbsp;`combine_json_files`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;directory&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Merge&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Remove&nbsp;duplicates&nbsp;from&nbsp;the&nbsp;combined&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Write&nbsp;the&nbsp;combined&nbsp;data&nbsp;to&nbsp;&#x27;instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Convert&nbsp;the&nbsp;merged&nbsp;JSON&nbsp;files&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;Return&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>[req05]&nbsp;The&nbsp;`create_code_graph`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Generate&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;file&nbsp;details.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;graphs&nbsp;as&nbsp;PNG&nbsp;images&nbsp;in&nbsp;the&nbsp;specified&nbsp;output&nbsp;directory.<br/>[req06]&nbsp;The&nbsp;`save_python_data`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;the&nbsp;details&nbsp;of&nbsp;the&nbsp;Python&nbsp;file&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Generate&nbsp;and&nbsp;save&nbsp;code&nbsp;graphs.<br/>&quot;&quot;&quot;<br/>import&nbsp;sys<br/>import&nbsp;os<br/>import&nbsp;re<br/>import&nbsp;json<br/>import&nbsp;logging<br/>import&nbsp;yaml<br/>import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br/>import&nbsp;networkx&nbsp;as&nbsp;nx<br/>from&nbsp;html&nbsp;import&nbsp;escape<br/>from&nbsp;pathlib&nbsp;import&nbsp;Path<br/>from&nbsp;typing&nbsp;import&nbsp;Dict,&nbsp;List,&nbsp;Union<br/><br/><br/>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)<br/><br/><br/>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)<br/><br/><br/>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;JSON&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int&nbsp;=&nbsp;4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&quot;&nbsp;&quot;,&nbsp;&quot;&amp;nbsp;&quot;).replace(&quot;\t&quot;,&nbsp;&quot;&amp;nbsp;&quot;&nbsp;*&nbsp;tab_width)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;&nbsp;width:&nbsp;100%;&nbsp;table-layout:&nbsp;fixed;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;black;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding:&nbsp;8px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;left;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;white-space:&nbsp;pre-line;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vertical-align:&nbsp;top;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word-wrap:&nbsp;break-word;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_count&nbsp;=&nbsp;len(dataset[0].keys())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_width&nbsp;=&nbsp;100&nbsp;/&nbsp;column_count&nbsp;&nbsp;#&nbsp;Calculate&nbsp;the&nbsp;width&nbsp;for&nbsp;each&nbsp;column&nbsp;based&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;columns<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&nbsp;style=&#x27;width:&nbsp;{column_width}%;&#x27;&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;tr&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;\n&nbsp;to&nbsp;HTML&nbsp;line&nbsp;breaks<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;td&gt;{value}&lt;/td&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;/tr&gt;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))<br/><br/><br/>def&nbsp;combine_json_files(directory:&nbsp;str)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dictionary&nbsp;containing&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name&nbsp;in&nbsp;[&#x27;instruct.json&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file_name<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file_name}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json_file_data&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(json_file_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;remove_duplicate_dataset_entries(combined_data,&nbsp;&#x27;instruction&#x27;,&nbsp;&#x27;output&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gen&nbsp;training&nbsp;datasets&nbsp;that&nbsp;contains&nbsp;purpose&nbsp;and&nbsp;graph&nbsp;data&nbsp;formatted&nbsp;as&nbsp;follow&nbsp;for&nbsp;each&nbsp;item&nbsp;in&nbsp;the&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;1)&nbsp;Describe&nbsp;the&nbsp;purpose&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;What&nbsp;is&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;Python&nbsp;code&nbsp;file&nbsp;that&nbsp;is&nbsp;described&nbsp;as&nbsp;follows:\n&#x27;+&nbsp;item[&#x27;output&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;input&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;graph_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&nbsp;for&nbsp;Python&nbsp;file:\n&#x27;&nbsp;+&nbsp;item[&#x27;input&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;output&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_graph_output&nbsp;=&nbsp;code_output&nbsp;+&nbsp;graph_output<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(code_graph_output,&nbsp;Path(directory)&nbsp;/&nbsp;&#x27;training.json&#x27;)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Save&nbsp;html&nbsp;file&nbsp;for&nbsp;each&nbsp;json&nbsp;file&nbsp;in&nbsp;the&nbsp;output&nbsp;directory<br/>&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;instruct_list&#x27;:&nbsp;instruct_data}<br/><br/><br/>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;graph_type&nbsp;=&nbsp;&#x27;entire_code_graph&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;graphs,&nbsp;add&nbsp;nodes,&nbsp;and&nbsp;add&nbsp;edges<br/>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;G.add_nodes_from(file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source,&nbsp;target&nbsp;=&nbsp;edge[&#x27;source&#x27;],&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**{k:&nbsp;v&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;edge.items()&nbsp;if&nbsp;k&nbsp;in&nbsp;[&#x27;target_inputs&#x27;,&nbsp;&#x27;target_returns&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Draw&nbsp;graphs<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size&nbsp;=&nbsp;8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[(edge[0],&nbsp;edge[1])]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)&nbsp;#&nbsp;Save&nbsp;the&nbsp;figure<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.close()&nbsp;&nbsp;#&nbsp;Close&nbsp;the&nbsp;figure<br/><br/><br/>def&nbsp;save_python_data(file_details:&nbsp;dict,&nbsp;instruct_list:&nbsp;list,&nbsp;relative_path:&nbsp;Path,&nbsp;output_dir:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Save&nbsp;Python&nbsp;file&nbsp;details&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file,&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;a&nbsp;JSON&nbsp;file,&nbsp;and&nbsp;code&nbsp;graphs.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_list&nbsp;(list):&nbsp;The&nbsp;instruction&nbsp;data&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relative_path&nbsp;(Path):&nbsp;The&nbsp;relative&nbsp;path&nbsp;to&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_dir&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;=&nbsp;Path(output_dir)&nbsp;/&nbsp;relative_path.parts[0]<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir.mkdir(parents=True,&nbsp;exist_ok=True)<br/>&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;=&nbsp;&#x27;.&#x27;.join(part&nbsp;for&nbsp;part&nbsp;in&nbsp;relative_path.parts)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;write&nbsp;instrunct.json&nbsp;files<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[f&#x27;{base_name}.instruct.json&#x27;,&nbsp;f&#x27;{base_name}.details.yaml&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;contents&nbsp;=&nbsp;[instruct_list,&nbsp;file_details]<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name,&nbsp;content&nbsp;in&nbsp;zip(file_names,&nbsp;contents):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(content,&nbsp;output_subdir&nbsp;/&nbsp;file_name)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create_code_graph(file_details,&nbsp;base_name,&nbsp;output_subdir)<br/>&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.info(f&#x27;Error&nbsp;creating&nbsp;graph&nbsp;for&nbsp;{base_name}&#x27;)<br/></td><td>sys,&nbsp;networkx,&nbsp;os,&nbsp;json,&nbsp;matplotlib.pyplot,&nbsp;html,&nbsp;re,&nbsp;yaml,&nbsp;typing,&nbsp;logging,&nbsp;pathlib</td></tr><tr><td>What&nbsp;is&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&nbsp;of&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>&quot;&quot;&quot;<br/>Utility&nbsp;functions&nbsp;for&nbsp;reading&nbsp;the&nbsp;input&nbsp;and&nbsp;saving&nbsp;the&nbsp;output&nbsp;of&nbsp;the&nbsp;py2dataset&nbsp;script.<br/>Requirements:<br/>[req01]&nbsp;The&nbsp;`read_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Read&nbsp;and&nbsp;return&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>[req02]&nbsp;The&nbsp;`write_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;dictionary&nbsp;and&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Write&nbsp;the&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;file&nbsp;in&nbsp;either&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;format.<br/>[req03]&nbsp;The&nbsp;`convert_json_to_html`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;each&nbsp;converted&nbsp;file&nbsp;with&nbsp;a&nbsp;.html&nbsp;extension.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Preserve&nbsp;spacing&nbsp;and&nbsp;tabs&nbsp;for&nbsp;the&nbsp;&#x27;input&#x27;&nbsp;field.<br/>[req04]&nbsp;The&nbsp;`combine_json_files`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;directory&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Merge&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Remove&nbsp;duplicates&nbsp;from&nbsp;the&nbsp;combined&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Write&nbsp;the&nbsp;combined&nbsp;data&nbsp;to&nbsp;&#x27;instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Convert&nbsp;the&nbsp;merged&nbsp;JSON&nbsp;files&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;Return&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>[req05]&nbsp;The&nbsp;`create_code_graph`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Generate&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;file&nbsp;details.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;graphs&nbsp;as&nbsp;PNG&nbsp;images&nbsp;in&nbsp;the&nbsp;specified&nbsp;output&nbsp;directory.<br/>[req06]&nbsp;The&nbsp;`save_python_data`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;the&nbsp;details&nbsp;of&nbsp;the&nbsp;Python&nbsp;file&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Generate&nbsp;and&nbsp;save&nbsp;code&nbsp;graphs.<br/>&quot;&quot;&quot;<br/>import&nbsp;sys<br/>import&nbsp;os<br/>import&nbsp;re<br/>import&nbsp;json<br/>import&nbsp;logging<br/>import&nbsp;yaml<br/>import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br/>import&nbsp;networkx&nbsp;as&nbsp;nx<br/>from&nbsp;html&nbsp;import&nbsp;escape<br/>from&nbsp;pathlib&nbsp;import&nbsp;Path<br/>from&nbsp;typing&nbsp;import&nbsp;Dict,&nbsp;List,&nbsp;Union<br/><br/><br/>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)<br/><br/><br/>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)<br/><br/><br/>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;JSON&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int&nbsp;=&nbsp;4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&quot;&nbsp;&quot;,&nbsp;&quot;&amp;nbsp;&quot;).replace(&quot;\t&quot;,&nbsp;&quot;&amp;nbsp;&quot;&nbsp;*&nbsp;tab_width)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;&nbsp;width:&nbsp;100%;&nbsp;table-layout:&nbsp;fixed;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;black;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding:&nbsp;8px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;left;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;white-space:&nbsp;pre-line;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vertical-align:&nbsp;top;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word-wrap:&nbsp;break-word;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_count&nbsp;=&nbsp;len(dataset[0].keys())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_width&nbsp;=&nbsp;100&nbsp;/&nbsp;column_count&nbsp;&nbsp;#&nbsp;Calculate&nbsp;the&nbsp;width&nbsp;for&nbsp;each&nbsp;column&nbsp;based&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;columns<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&nbsp;style=&#x27;width:&nbsp;{column_width}%;&#x27;&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;tr&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;\n&nbsp;to&nbsp;HTML&nbsp;line&nbsp;breaks<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;td&gt;{value}&lt;/td&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;/tr&gt;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))<br/><br/><br/>def&nbsp;combine_json_files(directory:&nbsp;str)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dictionary&nbsp;containing&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name&nbsp;in&nbsp;[&#x27;instruct.json&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file_name<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file_name}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json_file_data&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(json_file_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;remove_duplicate_dataset_entries(combined_data,&nbsp;&#x27;instruction&#x27;,&nbsp;&#x27;output&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gen&nbsp;training&nbsp;datasets&nbsp;that&nbsp;contains&nbsp;purpose&nbsp;and&nbsp;graph&nbsp;data&nbsp;formatted&nbsp;as&nbsp;follow&nbsp;for&nbsp;each&nbsp;item&nbsp;in&nbsp;the&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;1)&nbsp;Describe&nbsp;the&nbsp;purpose&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;What&nbsp;is&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;Python&nbsp;code&nbsp;file&nbsp;that&nbsp;is&nbsp;described&nbsp;as&nbsp;follows:\n&#x27;+&nbsp;item[&#x27;output&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;input&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;graph_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&nbsp;for&nbsp;Python&nbsp;file:\n&#x27;&nbsp;+&nbsp;item[&#x27;input&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;output&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_graph_output&nbsp;=&nbsp;code_output&nbsp;+&nbsp;graph_output<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(code_graph_output,&nbsp;Path(directory)&nbsp;/&nbsp;&#x27;training.json&#x27;)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Save&nbsp;html&nbsp;file&nbsp;for&nbsp;each&nbsp;json&nbsp;file&nbsp;in&nbsp;the&nbsp;output&nbsp;directory<br/>&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;instruct_list&#x27;:&nbsp;instruct_data}<br/><br/><br/>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;graph_type&nbsp;=&nbsp;&#x27;entire_code_graph&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;graphs,&nbsp;add&nbsp;nodes,&nbsp;and&nbsp;add&nbsp;edges<br/>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;G.add_nodes_from(file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source,&nbsp;target&nbsp;=&nbsp;edge[&#x27;source&#x27;],&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**{k:&nbsp;v&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;edge.items()&nbsp;if&nbsp;k&nbsp;in&nbsp;[&#x27;target_inputs&#x27;,&nbsp;&#x27;target_returns&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Draw&nbsp;graphs<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size&nbsp;=&nbsp;8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[(edge[0],&nbsp;edge[1])]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)&nbsp;#&nbsp;Save&nbsp;the&nbsp;figure<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.close()&nbsp;&nbsp;#&nbsp;Close&nbsp;the&nbsp;figure<br/><br/><br/>def&nbsp;save_python_data(file_details:&nbsp;dict,&nbsp;instruct_list:&nbsp;list,&nbsp;relative_path:&nbsp;Path,&nbsp;output_dir:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Save&nbsp;Python&nbsp;file&nbsp;details&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file,&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;a&nbsp;JSON&nbsp;file,&nbsp;and&nbsp;code&nbsp;graphs.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_list&nbsp;(list):&nbsp;The&nbsp;instruction&nbsp;data&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relative_path&nbsp;(Path):&nbsp;The&nbsp;relative&nbsp;path&nbsp;to&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_dir&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;=&nbsp;Path(output_dir)&nbsp;/&nbsp;relative_path.parts[0]<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir.mkdir(parents=True,&nbsp;exist_ok=True)<br/>&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;=&nbsp;&#x27;.&#x27;.join(part&nbsp;for&nbsp;part&nbsp;in&nbsp;relative_path.parts)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;write&nbsp;instrunct.json&nbsp;files<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[f&#x27;{base_name}.instruct.json&#x27;,&nbsp;f&#x27;{base_name}.details.yaml&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;contents&nbsp;=&nbsp;[instruct_list,&nbsp;file_details]<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name,&nbsp;content&nbsp;in&nbsp;zip(file_names,&nbsp;contents):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(content,&nbsp;output_subdir&nbsp;/&nbsp;file_name)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create_code_graph(file_details,&nbsp;base_name,&nbsp;output_subdir)<br/>&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.info(f&#x27;Error&nbsp;creating&nbsp;graph&nbsp;for&nbsp;{base_name}&#x27;)<br/></td><td>{&#x27;nodes&#x27;:&nbsp;[&#x27;read_file&#x27;,&nbsp;&#x27;write_file&#x27;,&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;preserve_spacing&#x27;,&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;remove_duplicate_dataset_entries&#x27;,&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;save_python_data&#x27;,&nbsp;&#x27;file_path.open&#x27;,&nbsp;&#x27;json.load&#x27;,&nbsp;&#x27;yaml.load&#x27;,&nbsp;&#x27;json.dump&#x27;,&nbsp;&#x27;yaml.dump&#x27;,&nbsp;&quot;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace&quot;,&nbsp;&#x27;text.replace&#x27;,&nbsp;&#x27;Path(directory).rglob&#x27;,&nbsp;&#x27;Path&#x27;,&nbsp;&#x27;json_file.with_suffix&#x27;,&nbsp;&#x27;len&#x27;,&nbsp;&#x27;dataset[0].keys&#x27;,&nbsp;&#x27;escape&#x27;,&nbsp;&#x27;str&#x27;,&nbsp;&#x27;value.replace&#x27;,&nbsp;&#x27;open&#x27;,&nbsp;&#x27;file.write&#x27;,&nbsp;&#x27;logging.save&#x27;,&nbsp;&#x27;logging.info&#x27;,&nbsp;&#x27;set&#x27;,&nbsp;&#x27;seen.add&#x27;,&nbsp;&#x27;result.append&#x27;,&nbsp;&#x27;combined_data.extend&#x27;,&nbsp;&#x27;combined_data.copy&#x27;,&nbsp;&quot;item[&#x27;instruction&#x27;].startswith&quot;,&nbsp;&#x27;code_output.append&#x27;,&nbsp;&#x27;graph_output.append&#x27;,&nbsp;&#x27;nx.DiGraph&#x27;,&nbsp;&#x27;G.add_nodes_from&#x27;,&nbsp;&#x27;G.add_edge&#x27;,&nbsp;&#x27;edge.items&#x27;,&nbsp;&#x27;plt.figure&#x27;,&nbsp;&#x27;nx.spring_layout&#x27;,&nbsp;&#x27;nx.draw&#x27;,&nbsp;&#x27;G.edges&#x27;,&nbsp;&#x27;label.append&#x27;,&nbsp;&quot;&#x27;,&nbsp;&#x27;.join&quot;,&nbsp;&quot;&#x27;\\n&#x27;.join&quot;,&nbsp;&#x27;nx.draw_networkx_edge_labels&#x27;,&nbsp;&#x27;plt.savefig&#x27;,&nbsp;&#x27;plt.close&#x27;,&nbsp;&#x27;output_subdir.mkdir&#x27;,&nbsp;&quot;&#x27;.&#x27;.join&quot;,&nbsp;&#x27;zip&#x27;],&nbsp;&#x27;edges&#x27;:&nbsp;[{&#x27;source&#x27;:&nbsp;&#x27;read_file&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;file_path.open&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;read_file&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;json.load&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;f&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;read_file&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;yaml.load&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;f&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;write_file&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;file_path.open&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;&#x27;w&#x27;&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;write_file&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;json.dump&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;data&#x27;,&nbsp;&#x27;f&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;write_file&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;yaml.dump&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;data&#x27;,&nbsp;&#x27;f&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&quot;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace&quot;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;&#x27;\\t&#x27;&quot;,&nbsp;&quot;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;text.replace&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;&#x27;&nbsp;&#x27;&quot;,&nbsp;&quot;&#x27;&amp;nbsp;&#x27;&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;Path(directory).rglob&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;&#x27;*.json&#x27;&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;Path&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;directory&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;read_file&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;json_file&#x27;],&nbsp;&#x27;target_returns&#x27;:&nbsp;[&#x27;json.load(f)&#x27;,&nbsp;&#x27;yaml.load(f)&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;json_file.with_suffix&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;&#x27;.html&#x27;&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;len&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;dataset[0].keys()&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;dataset[0].keys&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;escape&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;str(entry[key])&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;str&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;entry[key]&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;preserve_spacing&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;value&#x27;],&nbsp;&#x27;target_returns&#x27;:&nbsp;[&quot;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;value.replace&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;&#x27;\\n&#x27;&quot;,&nbsp;&quot;&#x27;&lt;br/&gt;&#x27;&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;open&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;html_file_path&#x27;,&nbsp;&quot;&#x27;w&#x27;&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;file.write&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;html_content&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;logging.save&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;)&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;logging.info&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;preserve_spacing&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&quot;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace&quot;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;&#x27;\\t&#x27;&quot;,&nbsp;&quot;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;preserve_spacing&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;text.replace&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;&#x27;&nbsp;&#x27;&quot;,&nbsp;&quot;&#x27;&amp;nbsp;&#x27;&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;set&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;seen.add&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;(item[key1],&nbsp;item[key2])&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;result.append&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;item&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;Path&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;directory&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;Path(directory).rglob&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;f&#x27;*.{file_name}&#x27;&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;read_file&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;json_file&#x27;],&nbsp;&#x27;target_returns&#x27;:&nbsp;[&#x27;json.load(f)&#x27;,&nbsp;&#x27;yaml.load(f)&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;combined_data.extend&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;json_file_data&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;remove_duplicate_dataset_entries&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;combined_data&#x27;,&nbsp;&quot;&#x27;instruction&#x27;&quot;,&nbsp;&quot;&#x27;output&#x27;&quot;],&nbsp;&#x27;target_returns&#x27;:&nbsp;[&#x27;result&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;combined_data.copy&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&quot;item[&#x27;instruction&#x27;].startswith&quot;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;&#x27;What&nbsp;is&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&#x27;&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;code_output.append&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;{&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;Python&nbsp;code&nbsp;file&nbsp;that&nbsp;is&nbsp;described&nbsp;as&nbsp;follows:\\n&#x27;&nbsp;+&nbsp;item[&#x27;output&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;input&#x27;]}&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;graph_output.append&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;{&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&nbsp;for&nbsp;Python&nbsp;file:\\n&#x27;&nbsp;+&nbsp;item[&#x27;input&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;output&#x27;]}&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;write_file&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;combined_data&#x27;,&nbsp;&#x27;file_path&#x27;],&nbsp;&#x27;target_returns&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;combine_json_files&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;convert_json_to_html&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;directory&#x27;],&nbsp;&#x27;target_returns&#x27;:&nbsp;[&quot;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;remove_duplicate_dataset_entries&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;set&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;remove_duplicate_dataset_entries&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;seen.add&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;(item[key1],&nbsp;item[key2])&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;remove_duplicate_dataset_entries&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;result.append&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;item&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;nx.DiGraph&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;G.add_nodes_from&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;G.add_edge&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;source&#x27;,&nbsp;&#x27;target&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;edge.items&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;plt.figure&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;nx.spring_layout&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;G&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;nx.draw&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;G&#x27;,&nbsp;&#x27;pos&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;G.edges&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;label.append&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;f&quot;\\nReturns:&nbsp;{\&#x27;,&nbsp;\&#x27;.join(edge[2][\&#x27;target_returns\&#x27;])}&quot;&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&quot;&#x27;,&nbsp;&#x27;.join&quot;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;edge[2][&#x27;target_returns&#x27;]&quot;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&quot;&#x27;\\n&#x27;.join&quot;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;label&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;nx.draw_networkx_edge_labels&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;G&#x27;,&nbsp;&#x27;pos&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;plt.savefig&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;output_file&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;plt.close&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;save_python_data&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;Path&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;output_dir&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;save_python_data&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;output_subdir.mkdir&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;save_python_data&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&quot;&#x27;.&#x27;.join&quot;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;(part&nbsp;for&nbsp;part&nbsp;in&nbsp;relative_path.parts)&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;save_python_data&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;zip&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;file_names&#x27;,&nbsp;&#x27;contents&#x27;]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;save_python_data&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;write_file&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;content&#x27;,&nbsp;&#x27;output_subdir&nbsp;/&nbsp;file_name&#x27;],&nbsp;&#x27;target_returns&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;save_python_data&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;create_code_graph&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&#x27;file_details&#x27;,&nbsp;&#x27;base_name&#x27;,&nbsp;&#x27;output_subdir&#x27;],&nbsp;&#x27;target_returns&#x27;:&nbsp;[]},&nbsp;{&#x27;source&#x27;:&nbsp;&#x27;save_python_data&#x27;,&nbsp;&#x27;target&#x27;:&nbsp;&#x27;logging.info&#x27;,&nbsp;&#x27;target_inputs&#x27;:&nbsp;[&quot;f&#x27;Error&nbsp;creating&nbsp;graph&nbsp;for&nbsp;{base_name}&#x27;&quot;]}]}</td></tr><tr><td>What&nbsp;functions&nbsp;are&nbsp;defined&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>&quot;&quot;&quot;<br/>Utility&nbsp;functions&nbsp;for&nbsp;reading&nbsp;the&nbsp;input&nbsp;and&nbsp;saving&nbsp;the&nbsp;output&nbsp;of&nbsp;the&nbsp;py2dataset&nbsp;script.<br/>Requirements:<br/>[req01]&nbsp;The&nbsp;`read_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Read&nbsp;and&nbsp;return&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>[req02]&nbsp;The&nbsp;`write_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;dictionary&nbsp;and&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Write&nbsp;the&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;file&nbsp;in&nbsp;either&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;format.<br/>[req03]&nbsp;The&nbsp;`convert_json_to_html`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;each&nbsp;converted&nbsp;file&nbsp;with&nbsp;a&nbsp;.html&nbsp;extension.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Preserve&nbsp;spacing&nbsp;and&nbsp;tabs&nbsp;for&nbsp;the&nbsp;&#x27;input&#x27;&nbsp;field.<br/>[req04]&nbsp;The&nbsp;`combine_json_files`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;directory&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Merge&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Remove&nbsp;duplicates&nbsp;from&nbsp;the&nbsp;combined&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Write&nbsp;the&nbsp;combined&nbsp;data&nbsp;to&nbsp;&#x27;instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Convert&nbsp;the&nbsp;merged&nbsp;JSON&nbsp;files&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;Return&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>[req05]&nbsp;The&nbsp;`create_code_graph`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Generate&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;file&nbsp;details.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;graphs&nbsp;as&nbsp;PNG&nbsp;images&nbsp;in&nbsp;the&nbsp;specified&nbsp;output&nbsp;directory.<br/>[req06]&nbsp;The&nbsp;`save_python_data`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;the&nbsp;details&nbsp;of&nbsp;the&nbsp;Python&nbsp;file&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Generate&nbsp;and&nbsp;save&nbsp;code&nbsp;graphs.<br/>&quot;&quot;&quot;<br/>import&nbsp;sys<br/>import&nbsp;os<br/>import&nbsp;re<br/>import&nbsp;json<br/>import&nbsp;logging<br/>import&nbsp;yaml<br/>import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br/>import&nbsp;networkx&nbsp;as&nbsp;nx<br/>from&nbsp;html&nbsp;import&nbsp;escape<br/>from&nbsp;pathlib&nbsp;import&nbsp;Path<br/>from&nbsp;typing&nbsp;import&nbsp;Dict,&nbsp;List,&nbsp;Union<br/><br/><br/>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)<br/><br/><br/>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)<br/><br/><br/>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;JSON&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int&nbsp;=&nbsp;4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&quot;&nbsp;&quot;,&nbsp;&quot;&amp;nbsp;&quot;).replace(&quot;\t&quot;,&nbsp;&quot;&amp;nbsp;&quot;&nbsp;*&nbsp;tab_width)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;&nbsp;width:&nbsp;100%;&nbsp;table-layout:&nbsp;fixed;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;black;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding:&nbsp;8px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;left;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;white-space:&nbsp;pre-line;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vertical-align:&nbsp;top;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word-wrap:&nbsp;break-word;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_count&nbsp;=&nbsp;len(dataset[0].keys())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_width&nbsp;=&nbsp;100&nbsp;/&nbsp;column_count&nbsp;&nbsp;#&nbsp;Calculate&nbsp;the&nbsp;width&nbsp;for&nbsp;each&nbsp;column&nbsp;based&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;columns<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&nbsp;style=&#x27;width:&nbsp;{column_width}%;&#x27;&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;tr&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;\n&nbsp;to&nbsp;HTML&nbsp;line&nbsp;breaks<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;td&gt;{value}&lt;/td&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;/tr&gt;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))<br/><br/><br/>def&nbsp;combine_json_files(directory:&nbsp;str)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dictionary&nbsp;containing&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name&nbsp;in&nbsp;[&#x27;instruct.json&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file_name<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file_name}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json_file_data&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(json_file_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;remove_duplicate_dataset_entries(combined_data,&nbsp;&#x27;instruction&#x27;,&nbsp;&#x27;output&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gen&nbsp;training&nbsp;datasets&nbsp;that&nbsp;contains&nbsp;purpose&nbsp;and&nbsp;graph&nbsp;data&nbsp;formatted&nbsp;as&nbsp;follow&nbsp;for&nbsp;each&nbsp;item&nbsp;in&nbsp;the&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;1)&nbsp;Describe&nbsp;the&nbsp;purpose&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;What&nbsp;is&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;Python&nbsp;code&nbsp;file&nbsp;that&nbsp;is&nbsp;described&nbsp;as&nbsp;follows:\n&#x27;+&nbsp;item[&#x27;output&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;input&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;graph_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&nbsp;for&nbsp;Python&nbsp;file:\n&#x27;&nbsp;+&nbsp;item[&#x27;input&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;output&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_graph_output&nbsp;=&nbsp;code_output&nbsp;+&nbsp;graph_output<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(code_graph_output,&nbsp;Path(directory)&nbsp;/&nbsp;&#x27;training.json&#x27;)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Save&nbsp;html&nbsp;file&nbsp;for&nbsp;each&nbsp;json&nbsp;file&nbsp;in&nbsp;the&nbsp;output&nbsp;directory<br/>&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;instruct_list&#x27;:&nbsp;instruct_data}<br/><br/><br/>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;graph_type&nbsp;=&nbsp;&#x27;entire_code_graph&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;graphs,&nbsp;add&nbsp;nodes,&nbsp;and&nbsp;add&nbsp;edges<br/>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;G.add_nodes_from(file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source,&nbsp;target&nbsp;=&nbsp;edge[&#x27;source&#x27;],&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**{k:&nbsp;v&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;edge.items()&nbsp;if&nbsp;k&nbsp;in&nbsp;[&#x27;target_inputs&#x27;,&nbsp;&#x27;target_returns&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Draw&nbsp;graphs<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size&nbsp;=&nbsp;8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[(edge[0],&nbsp;edge[1])]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)&nbsp;#&nbsp;Save&nbsp;the&nbsp;figure<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.close()&nbsp;&nbsp;#&nbsp;Close&nbsp;the&nbsp;figure<br/><br/><br/>def&nbsp;save_python_data(file_details:&nbsp;dict,&nbsp;instruct_list:&nbsp;list,&nbsp;relative_path:&nbsp;Path,&nbsp;output_dir:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Save&nbsp;Python&nbsp;file&nbsp;details&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file,&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;a&nbsp;JSON&nbsp;file,&nbsp;and&nbsp;code&nbsp;graphs.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_list&nbsp;(list):&nbsp;The&nbsp;instruction&nbsp;data&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relative_path&nbsp;(Path):&nbsp;The&nbsp;relative&nbsp;path&nbsp;to&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_dir&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;=&nbsp;Path(output_dir)&nbsp;/&nbsp;relative_path.parts[0]<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir.mkdir(parents=True,&nbsp;exist_ok=True)<br/>&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;=&nbsp;&#x27;.&#x27;.join(part&nbsp;for&nbsp;part&nbsp;in&nbsp;relative_path.parts)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;write&nbsp;instrunct.json&nbsp;files<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[f&#x27;{base_name}.instruct.json&#x27;,&nbsp;f&#x27;{base_name}.details.yaml&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;contents&nbsp;=&nbsp;[instruct_list,&nbsp;file_details]<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name,&nbsp;content&nbsp;in&nbsp;zip(file_names,&nbsp;contents):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(content,&nbsp;output_subdir&nbsp;/&nbsp;file_name)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create_code_graph(file_details,&nbsp;base_name,&nbsp;output_subdir)<br/>&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.info(f&#x27;Error&nbsp;creating&nbsp;graph&nbsp;for&nbsp;{base_name}&#x27;)<br/></td><td>convert_json_to_html,&nbsp;remove_duplicate_dataset_entries,&nbsp;read_file,&nbsp;preserve_spacing,&nbsp;save_python_data,&nbsp;write_file,&nbsp;combine_json_files,&nbsp;create_code_graph</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;inputs&nbsp;to&nbsp;the&nbsp;function:&nbsp;&#x27;read_file&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)</td><td>file_path</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;inputs&nbsp;to&nbsp;the&nbsp;function:&nbsp;&#x27;write_file&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)</td><td>file_path,&nbsp;data</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;inputs&nbsp;to&nbsp;the&nbsp;function:&nbsp;&#x27;convert_json_to_html&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;JSON&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;&nbsp;width:&nbsp;100%;&nbsp;table-layout:&nbsp;fixed;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;black;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding:&nbsp;8px;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;left;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;white-space:&nbsp;pre-line;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vertical-align:&nbsp;top;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word-wrap:&nbsp;break-word;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_count&nbsp;=&nbsp;len(dataset[0].keys())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_width&nbsp;=&nbsp;100&nbsp;/&nbsp;column_count<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&nbsp;style=&#x27;width:&nbsp;{column_width}%;&#x27;&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;td&gt;{value}&lt;/td&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;/tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))</td><td>directory</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;inputs&nbsp;to&nbsp;the&nbsp;function:&nbsp;&#x27;preserve_spacing&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)</td><td>text,&nbsp;tab_width</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;inputs&nbsp;to&nbsp;the&nbsp;function:&nbsp;&#x27;combine_json_files&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;combine_json_files(directory:&nbsp;str)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dictionary&nbsp;containing&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result<br/>&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name&nbsp;in&nbsp;[&#x27;instruct.json&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file_name<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file_name}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json_file_data&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(json_file_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;remove_duplicate_dataset_entries(combined_data,&nbsp;&#x27;instruction&#x27;,&nbsp;&#x27;output&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;1)&nbsp;Describe&nbsp;the&nbsp;purpose&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;What&nbsp;is&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;Python&nbsp;code&nbsp;file&nbsp;that&nbsp;is&nbsp;described&nbsp;as&nbsp;follows:\n&#x27;&nbsp;+&nbsp;item[&#x27;output&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;input&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;graph_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&nbsp;for&nbsp;Python&nbsp;file:\n&#x27;&nbsp;+&nbsp;item[&#x27;input&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;output&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_graph_output&nbsp;=&nbsp;code_output&nbsp;+&nbsp;graph_output<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(code_graph_output,&nbsp;Path(directory)&nbsp;/&nbsp;&#x27;training.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;instruct_list&#x27;:&nbsp;instruct_data}</td><td>directory</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;inputs&nbsp;to&nbsp;the&nbsp;function:&nbsp;&#x27;remove_duplicate_dataset_entries&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result</td><td>dataset,&nbsp;key2,&nbsp;key1</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;inputs&nbsp;to&nbsp;the&nbsp;function:&nbsp;&#x27;create_code_graph&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;graph_type&nbsp;=&nbsp;&#x27;entire_code_graph&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;G.add_nodes_from(file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source,&nbsp;target&nbsp;=&nbsp;(edge[&#x27;source&#x27;],&nbsp;edge[&#x27;target&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**{k:&nbsp;v&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;edge.items()&nbsp;if&nbsp;k&nbsp;in&nbsp;[&#x27;target_inputs&#x27;,&nbsp;&#x27;target_returns&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size=8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[edge[0],&nbsp;edge[1]]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</td><td>output_subdir,&nbsp;base_name,&nbsp;file_details</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;inputs&nbsp;to&nbsp;the&nbsp;function:&nbsp;&#x27;save_python_data&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;save_python_data(file_details:&nbsp;dict,&nbsp;instruct_list:&nbsp;list,&nbsp;relative_path:&nbsp;Path,&nbsp;output_dir:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Save&nbsp;Python&nbsp;file&nbsp;details&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file,&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;a&nbsp;JSON&nbsp;file,&nbsp;and&nbsp;code&nbsp;graphs.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_list&nbsp;(list):&nbsp;The&nbsp;instruction&nbsp;data&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relative_path&nbsp;(Path):&nbsp;The&nbsp;relative&nbsp;path&nbsp;to&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_dir&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;=&nbsp;Path(output_dir)&nbsp;/&nbsp;relative_path.parts[0]<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir.mkdir(parents=True,&nbsp;exist_ok=True)<br/>&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;=&nbsp;&#x27;.&#x27;.join((part&nbsp;for&nbsp;part&nbsp;in&nbsp;relative_path.parts))<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[f&#x27;{base_name}.instruct.json&#x27;,&nbsp;f&#x27;{base_name}.details.yaml&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;contents&nbsp;=&nbsp;[instruct_list,&nbsp;file_details]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name,&nbsp;content&nbsp;in&nbsp;zip(file_names,&nbsp;contents):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(content,&nbsp;output_subdir&nbsp;/&nbsp;file_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create_code_graph(file_details,&nbsp;base_name,&nbsp;output_subdir)<br/>&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.info(f&#x27;Error&nbsp;creating&nbsp;graph&nbsp;for&nbsp;{base_name}&#x27;)</td><td>relative_path,&nbsp;output_dir,&nbsp;instruct_list,&nbsp;file_details</td></tr><tr><td>What&nbsp;is&nbsp;the&nbsp;docstring&nbsp;of&nbsp;the&nbsp;function:&nbsp;&#x27;read_file&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)</td><td>Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.&nbsp;Args:&nbsp;file_path&nbsp;Path:&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.&nbsp;Returns:&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.</td></tr><tr><td>What&nbsp;is&nbsp;the&nbsp;docstring&nbsp;of&nbsp;the&nbsp;function:&nbsp;&#x27;write_file&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)</td><td>Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;Args:&nbsp;data&nbsp;Dict:&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.&nbsp;file_path&nbsp;Path:&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.&nbsp;Returns:&nbsp;None</td></tr><tr><td>What&nbsp;is&nbsp;the&nbsp;docstring&nbsp;of&nbsp;the&nbsp;function:&nbsp;&#x27;convert_json_to_html&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;JSON&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;&nbsp;width:&nbsp;100%;&nbsp;table-layout:&nbsp;fixed;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;black;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding:&nbsp;8px;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;left;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;white-space:&nbsp;pre-line;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vertical-align:&nbsp;top;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word-wrap:&nbsp;break-word;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_count&nbsp;=&nbsp;len(dataset[0].keys())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_width&nbsp;=&nbsp;100&nbsp;/&nbsp;column_count<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&nbsp;style=&#x27;width:&nbsp;{column_width}%;&#x27;&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;td&gt;{value}&lt;/td&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;/tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))</td><td>Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.&nbsp;Args:&nbsp;directory&nbsp;str:&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;JSON&nbsp;files&nbsp;are&nbsp;located.&nbsp;Returns:&nbsp;None</td></tr><tr><td>What&nbsp;is&nbsp;the&nbsp;docstring&nbsp;of&nbsp;the&nbsp;function:&nbsp;&#x27;preserve_spacing&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)</td><td>Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.</td></tr><tr><td>What&nbsp;is&nbsp;the&nbsp;docstring&nbsp;of&nbsp;the&nbsp;function:&nbsp;&#x27;combine_json_files&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;combine_json_files(directory:&nbsp;str)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dictionary&nbsp;containing&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result<br/>&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name&nbsp;in&nbsp;[&#x27;instruct.json&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file_name<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file_name}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json_file_data&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(json_file_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;remove_duplicate_dataset_entries(combined_data,&nbsp;&#x27;instruction&#x27;,&nbsp;&#x27;output&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;1)&nbsp;Describe&nbsp;the&nbsp;purpose&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;What&nbsp;is&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;Python&nbsp;code&nbsp;file&nbsp;that&nbsp;is&nbsp;described&nbsp;as&nbsp;follows:\n&#x27;&nbsp;+&nbsp;item[&#x27;output&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;input&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;graph_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&nbsp;for&nbsp;Python&nbsp;file:\n&#x27;&nbsp;+&nbsp;item[&#x27;input&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;output&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_graph_output&nbsp;=&nbsp;code_output&nbsp;+&nbsp;graph_output<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(code_graph_output,&nbsp;Path(directory)&nbsp;/&nbsp;&#x27;training.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;instruct_list&#x27;:&nbsp;instruct_data}</td><td>Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;instruct.json,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.&nbsp;Args:&nbsp;directory&nbsp;str:&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.&nbsp;Returns:&nbsp;A&nbsp;dictionary&nbsp;containing&nbsp;the&nbsp;instruct_list&nbsp;datasets.</td></tr><tr><td>What&nbsp;is&nbsp;the&nbsp;docstring&nbsp;of&nbsp;the&nbsp;function:&nbsp;&#x27;remove_duplicate_dataset_entries&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result</td><td>Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.&nbsp;Args:&nbsp;dataset&nbsp;ListDict:&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.&nbsp;key1&nbsp;str:&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.&nbsp;key2&nbsp;str:&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.&nbsp;Returns:&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.</td></tr><tr><td>What&nbsp;is&nbsp;the&nbsp;docstring&nbsp;of&nbsp;the&nbsp;function:&nbsp;&#x27;create_code_graph&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;graph_type&nbsp;=&nbsp;&#x27;entire_code_graph&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;G.add_nodes_from(file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source,&nbsp;target&nbsp;=&nbsp;(edge[&#x27;source&#x27;],&nbsp;edge[&#x27;target&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**{k:&nbsp;v&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;edge.items()&nbsp;if&nbsp;k&nbsp;in&nbsp;[&#x27;target_inputs&#x27;,&nbsp;&#x27;target_returns&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size=8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[edge[0],&nbsp;edge[1]]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</td><td>Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.&nbsp;Args:&nbsp;file_details&nbsp;dict:&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.&nbsp;base_name&nbsp;str:&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.&nbsp;output_subdir&nbsp;Path:&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.&nbsp;Returns:&nbsp;None</td></tr><tr><td>What&nbsp;is&nbsp;the&nbsp;docstring&nbsp;of&nbsp;the&nbsp;function:&nbsp;&#x27;save_python_data&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;save_python_data(file_details:&nbsp;dict,&nbsp;instruct_list:&nbsp;list,&nbsp;relative_path:&nbsp;Path,&nbsp;output_dir:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Save&nbsp;Python&nbsp;file&nbsp;details&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file,&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;a&nbsp;JSON&nbsp;file,&nbsp;and&nbsp;code&nbsp;graphs.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_list&nbsp;(list):&nbsp;The&nbsp;instruction&nbsp;data&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relative_path&nbsp;(Path):&nbsp;The&nbsp;relative&nbsp;path&nbsp;to&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_dir&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;=&nbsp;Path(output_dir)&nbsp;/&nbsp;relative_path.parts[0]<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir.mkdir(parents=True,&nbsp;exist_ok=True)<br/>&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;=&nbsp;&#x27;.&#x27;.join((part&nbsp;for&nbsp;part&nbsp;in&nbsp;relative_path.parts))<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[f&#x27;{base_name}.instruct.json&#x27;,&nbsp;f&#x27;{base_name}.details.yaml&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;contents&nbsp;=&nbsp;[instruct_list,&nbsp;file_details]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name,&nbsp;content&nbsp;in&nbsp;zip(file_names,&nbsp;contents):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(content,&nbsp;output_subdir&nbsp;/&nbsp;file_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create_code_graph(file_details,&nbsp;base_name,&nbsp;output_subdir)<br/>&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.info(f&#x27;Error&nbsp;creating&nbsp;graph&nbsp;for&nbsp;{base_name}&#x27;)</td><td>and&nbsp;code&nbsp;graphs.&nbsp;Args:&nbsp;file_details&nbsp;dict:&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.&nbsp;instruct_list&nbsp;list:&nbsp;The&nbsp;instruction&nbsp;data&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.&nbsp;relative_path&nbsp;Path:&nbsp;The&nbsp;relative&nbsp;path&nbsp;to&nbsp;the&nbsp;Python&nbsp;file.&nbsp;output_dir&nbsp;str:&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.&nbsp;Returns:&nbsp;None,&nbsp;Save&nbsp;Python&nbsp;file&nbsp;details&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file,&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;a&nbsp;JSON&nbsp;file</td></tr><tr><td>What&nbsp;calls&nbsp;are&nbsp;made&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;read_file&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)</td><td>yaml.load,&nbsp;file_path.open,&nbsp;json.load</td></tr><tr><td>What&nbsp;calls&nbsp;are&nbsp;made&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;write_file&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)</td><td>yaml.dump,&nbsp;file_path.open,&nbsp;json.dump</td></tr><tr><td>What&nbsp;calls&nbsp;are&nbsp;made&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;convert_json_to_html&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;JSON&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;&nbsp;width:&nbsp;100%;&nbsp;table-layout:&nbsp;fixed;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;black;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding:&nbsp;8px;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;left;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;white-space:&nbsp;pre-line;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vertical-align:&nbsp;top;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word-wrap:&nbsp;break-word;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_count&nbsp;=&nbsp;len(dataset[0].keys())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_width&nbsp;=&nbsp;100&nbsp;/&nbsp;column_count<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&nbsp;style=&#x27;width:&nbsp;{column_width}%;&#x27;&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;td&gt;{value}&lt;/td&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;/tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))</td><td>Pathdirectory.rglob,&nbsp;logging.info,&nbsp;dataset0.keys,&nbsp;len,&nbsp;Path,&nbsp;nbsp.replace,&nbsp;escape,&nbsp;text.replace,&nbsp;file.write,&nbsp;read_file,&nbsp;str,&nbsp;preserve_spacing,&nbsp;json_file.with_suffix,&nbsp;value.replace,&nbsp;text.replace&nbsp;,&nbsp;logging.save,&nbsp;open</td></tr><tr><td>What&nbsp;calls&nbsp;are&nbsp;made&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;preserve_spacing&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)</td><td>text.replace&nbsp;,&nbsp;nbsp.replace,&nbsp;text.replace</td></tr><tr><td>What&nbsp;calls&nbsp;are&nbsp;made&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;combine_json_files&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;combine_json_files(directory:&nbsp;str)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dictionary&nbsp;containing&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result<br/>&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name&nbsp;in&nbsp;[&#x27;instruct.json&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file_name<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file_name}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json_file_data&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(json_file_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;remove_duplicate_dataset_entries(combined_data,&nbsp;&#x27;instruction&#x27;,&nbsp;&#x27;output&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;1)&nbsp;Describe&nbsp;the&nbsp;purpose&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;What&nbsp;is&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;Python&nbsp;code&nbsp;file&nbsp;that&nbsp;is&nbsp;described&nbsp;as&nbsp;follows:\n&#x27;&nbsp;+&nbsp;item[&#x27;output&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;input&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;graph_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&nbsp;for&nbsp;Python&nbsp;file:\n&#x27;&nbsp;+&nbsp;item[&#x27;input&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;output&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_graph_output&nbsp;=&nbsp;code_output&nbsp;+&nbsp;graph_output<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(code_graph_output,&nbsp;Path(directory)&nbsp;/&nbsp;&#x27;training.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;instruct_list&#x27;:&nbsp;instruct_data}</td><td>Pathdirectory.rglob,&nbsp;combined_data.copy,&nbsp;graph_output.append,&nbsp;convert_json_to_html,&nbsp;code_output.append,&nbsp;Path,&nbsp;remove_duplicate_dataset_entries,&nbsp;read_file,&nbsp;result.append,&nbsp;combined_data.extend,&nbsp;iteminstruction.startswith,&nbsp;seen.add,&nbsp;write_file,&nbsp;set</td></tr><tr><td>What&nbsp;calls&nbsp;are&nbsp;made&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;remove_duplicate_dataset_entries&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result</td><td>result.append,&nbsp;set,&nbsp;seen.add</td></tr><tr><td>What&nbsp;calls&nbsp;are&nbsp;made&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;create_code_graph&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;graph_type&nbsp;=&nbsp;&#x27;entire_code_graph&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;G.add_nodes_from(file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source,&nbsp;target&nbsp;=&nbsp;(edge[&#x27;source&#x27;],&nbsp;edge[&#x27;target&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**{k:&nbsp;v&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;edge.items()&nbsp;if&nbsp;k&nbsp;in&nbsp;[&#x27;target_inputs&#x27;,&nbsp;&#x27;target_returns&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size=8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[edge[0],&nbsp;edge[1]]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</td><td>,&nbsp;G.add_nodes_from,&nbsp;n.join,&nbsp;label.append,&nbsp;G.add_edge,&nbsp;.join,&nbsp;nx.draw,&nbsp;plt.close,&nbsp;plt.savefig,&nbsp;nx.spring_layout,&nbsp;nx.DiGraph,&nbsp;G.edges,&nbsp;edge.items,&nbsp;nx.draw_networkx_edge_labels,&nbsp;plt.figure</td></tr><tr><td>What&nbsp;calls&nbsp;are&nbsp;made&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;save_python_data&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;save_python_data(file_details:&nbsp;dict,&nbsp;instruct_list:&nbsp;list,&nbsp;relative_path:&nbsp;Path,&nbsp;output_dir:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Save&nbsp;Python&nbsp;file&nbsp;details&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file,&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;a&nbsp;JSON&nbsp;file,&nbsp;and&nbsp;code&nbsp;graphs.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_list&nbsp;(list):&nbsp;The&nbsp;instruction&nbsp;data&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relative_path&nbsp;(Path):&nbsp;The&nbsp;relative&nbsp;path&nbsp;to&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_dir&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;=&nbsp;Path(output_dir)&nbsp;/&nbsp;relative_path.parts[0]<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir.mkdir(parents=True,&nbsp;exist_ok=True)<br/>&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;=&nbsp;&#x27;.&#x27;.join((part&nbsp;for&nbsp;part&nbsp;in&nbsp;relative_path.parts))<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[f&#x27;{base_name}.instruct.json&#x27;,&nbsp;f&#x27;{base_name}.details.yaml&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;contents&nbsp;=&nbsp;[instruct_list,&nbsp;file_details]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name,&nbsp;content&nbsp;in&nbsp;zip(file_names,&nbsp;contents):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(content,&nbsp;output_subdir&nbsp;/&nbsp;file_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create_code_graph(file_details,&nbsp;base_name,&nbsp;output_subdir)<br/>&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.info(f&#x27;Error&nbsp;creating&nbsp;graph&nbsp;for&nbsp;{base_name}&#x27;)</td><td>logging.info,&nbsp;Path,&nbsp;zip,&nbsp;write_file,&nbsp;create_code_graph,&nbsp;output_subdir.mkdir,&nbsp;..join</td></tr><tr><td>What&nbsp;variables&nbsp;are&nbsp;defined&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;read_file&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)</td><td>file_type</td></tr><tr><td>What&nbsp;variables&nbsp;are&nbsp;defined&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;write_file&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)</td><td>file_type</td></tr><tr><td>What&nbsp;variables&nbsp;are&nbsp;defined&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;convert_json_to_html&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;JSON&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;&nbsp;width:&nbsp;100%;&nbsp;table-layout:&nbsp;fixed;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;black;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding:&nbsp;8px;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;left;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;white-space:&nbsp;pre-line;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vertical-align:&nbsp;top;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word-wrap:&nbsp;break-word;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_count&nbsp;=&nbsp;len(dataset[0].keys())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_width&nbsp;=&nbsp;100&nbsp;/&nbsp;column_count<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&nbsp;style=&#x27;width:&nbsp;{column_width}%;&#x27;&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;td&gt;{value}&lt;/td&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;/tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))</td><td>column_width,&nbsp;html_content,&nbsp;html_file,&nbsp;column_count,&nbsp;html_file_path,&nbsp;value,&nbsp;dataset</td></tr><tr><td>What&nbsp;variables&nbsp;are&nbsp;defined&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;combine_json_files&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;combine_json_files(directory:&nbsp;str)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dictionary&nbsp;containing&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result<br/>&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name&nbsp;in&nbsp;[&#x27;instruct.json&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file_name<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file_name}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json_file_data&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(json_file_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;remove_duplicate_dataset_entries(combined_data,&nbsp;&#x27;instruction&#x27;,&nbsp;&#x27;output&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;1)&nbsp;Describe&nbsp;the&nbsp;purpose&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;What&nbsp;is&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;Python&nbsp;code&nbsp;file&nbsp;that&nbsp;is&nbsp;described&nbsp;as&nbsp;follows:\n&#x27;&nbsp;+&nbsp;item[&#x27;output&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;input&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;graph_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&nbsp;for&nbsp;Python&nbsp;file:\n&#x27;&nbsp;+&nbsp;item[&#x27;input&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;output&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_graph_output&nbsp;=&nbsp;code_output&nbsp;+&nbsp;graph_output<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(code_graph_output,&nbsp;Path(directory)&nbsp;/&nbsp;&#x27;training.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;instruct_list&#x27;:&nbsp;instruct_data}</td><td>purpose_data,&nbsp;graph_data,&nbsp;code_graph_output,&nbsp;instruct_data,&nbsp;graph_output,&nbsp;combined_data,&nbsp;result,&nbsp;seen,&nbsp;code_output,&nbsp;file_path,&nbsp;json_file_data</td></tr><tr><td>What&nbsp;variables&nbsp;are&nbsp;defined&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;remove_duplicate_dataset_entries&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result</td><td>seen,&nbsp;result</td></tr><tr><td>What&nbsp;variables&nbsp;are&nbsp;defined&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;create_code_graph&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;graph_type&nbsp;=&nbsp;&#x27;entire_code_graph&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;G.add_nodes_from(file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source,&nbsp;target&nbsp;=&nbsp;(edge[&#x27;source&#x27;],&nbsp;edge[&#x27;target&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**{k:&nbsp;v&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;edge.items()&nbsp;if&nbsp;k&nbsp;in&nbsp;[&#x27;target_inputs&#x27;,&nbsp;&#x27;target_returns&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size=8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[edge[0],&nbsp;edge[1]]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</td><td>G,&nbsp;edge_labels,&nbsp;label,&nbsp;graph_type,&nbsp;output_file,&nbsp;pos</td></tr><tr><td>What&nbsp;variables&nbsp;are&nbsp;defined&nbsp;in&nbsp;the&nbsp;function:&nbsp;&#x27;save_python_data&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;save_python_data(file_details:&nbsp;dict,&nbsp;instruct_list:&nbsp;list,&nbsp;relative_path:&nbsp;Path,&nbsp;output_dir:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Save&nbsp;Python&nbsp;file&nbsp;details&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file,&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;a&nbsp;JSON&nbsp;file,&nbsp;and&nbsp;code&nbsp;graphs.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_list&nbsp;(list):&nbsp;The&nbsp;instruction&nbsp;data&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relative_path&nbsp;(Path):&nbsp;The&nbsp;relative&nbsp;path&nbsp;to&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_dir&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;=&nbsp;Path(output_dir)&nbsp;/&nbsp;relative_path.parts[0]<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir.mkdir(parents=True,&nbsp;exist_ok=True)<br/>&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;=&nbsp;&#x27;.&#x27;.join((part&nbsp;for&nbsp;part&nbsp;in&nbsp;relative_path.parts))<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[f&#x27;{base_name}.instruct.json&#x27;,&nbsp;f&#x27;{base_name}.details.yaml&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;contents&nbsp;=&nbsp;[instruct_list,&nbsp;file_details]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name,&nbsp;content&nbsp;in&nbsp;zip(file_names,&nbsp;contents):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(content,&nbsp;output_subdir&nbsp;/&nbsp;file_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create_code_graph(file_details,&nbsp;base_name,&nbsp;output_subdir)<br/>&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.info(f&#x27;Error&nbsp;creating&nbsp;graph&nbsp;for&nbsp;{base_name}&#x27;)</td><td>output_subdir,&nbsp;file_names,&nbsp;contents,&nbsp;base_name</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;returned&nbsp;items&nbsp;from&nbsp;the&nbsp;function:&nbsp;&#x27;read_file&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)</td><td>json.loadf,&nbsp;yaml.loadf</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;returned&nbsp;items&nbsp;from&nbsp;the&nbsp;function:&nbsp;&#x27;convert_json_to_html&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;JSON&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;&nbsp;width:&nbsp;100%;&nbsp;table-layout:&nbsp;fixed;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;black;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding:&nbsp;8px;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;left;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;white-space:&nbsp;pre-line;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vertical-align:&nbsp;top;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word-wrap:&nbsp;break-word;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_count&nbsp;=&nbsp;len(dataset[0].keys())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_width&nbsp;=&nbsp;100&nbsp;/&nbsp;column_count<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&nbsp;style=&#x27;width:&nbsp;{column_width}%;&#x27;&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;td&gt;{value}&lt;/td&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;/tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))</td><td>text.replace&nbsp;,&nbsp;nbsp.replacet,&nbsp;nbsp&nbsp;&nbsp;tab_width</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;returned&nbsp;items&nbsp;from&nbsp;the&nbsp;function:&nbsp;&#x27;preserve_spacing&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)</td><td>text.replace&nbsp;,&nbsp;nbsp.replacet,&nbsp;nbsp&nbsp;&nbsp;tab_width</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;returned&nbsp;items&nbsp;from&nbsp;the&nbsp;function:&nbsp;&#x27;combine_json_files&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;combine_json_files(directory:&nbsp;str)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dictionary&nbsp;containing&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result<br/>&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name&nbsp;in&nbsp;[&#x27;instruct.json&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file_name<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file_name}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json_file_data&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(json_file_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;remove_duplicate_dataset_entries(combined_data,&nbsp;&#x27;instruction&#x27;,&nbsp;&#x27;output&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;1)&nbsp;Describe&nbsp;the&nbsp;purpose&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;What&nbsp;is&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;Python&nbsp;code&nbsp;file&nbsp;that&nbsp;is&nbsp;described&nbsp;as&nbsp;follows:\n&#x27;&nbsp;+&nbsp;item[&#x27;output&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;input&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;graph_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&nbsp;for&nbsp;Python&nbsp;file:\n&#x27;&nbsp;+&nbsp;item[&#x27;input&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;output&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_graph_output&nbsp;=&nbsp;code_output&nbsp;+&nbsp;graph_output<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(code_graph_output,&nbsp;Path(directory)&nbsp;/&nbsp;&#x27;training.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;instruct_list&#x27;:&nbsp;instruct_data}</td><td>instruct_list:&nbsp;instruct_data,&nbsp;result</td></tr><tr><td>What&nbsp;are&nbsp;the&nbsp;returned&nbsp;items&nbsp;from&nbsp;the&nbsp;function:&nbsp;&#x27;remove_duplicate_dataset_entries&#x27;&nbsp;in&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result</td><td>result</td></tr><tr><td>1)&nbsp;Describe&nbsp;the&nbsp;purpose&nbsp;and&nbsp;processing&nbsp;summary&nbsp;of&nbsp;the&nbsp;Python&nbsp;file:&nbsp;&#x27;py2dataset.save_py2dataset_output.py;&nbsp;2)&nbsp;Provide&nbsp;an&nbsp;itemized&nbsp;detailed&nbsp;description&nbsp;of&nbsp;each&nbsp;applicable&nbsp;function,&nbsp;class,&nbsp;and&nbsp;method;&nbsp;3)&nbsp;Explain&nbsp;what&nbsp;each&nbsp;of&nbsp;input,&nbsp;output,&nbsp;and&nbsp;variable&nbsp;do&nbsp;within&nbsp;the&nbsp;file.</td><td>&quot;&quot;&quot;<br/>Utility&nbsp;functions&nbsp;for&nbsp;reading&nbsp;the&nbsp;input&nbsp;and&nbsp;saving&nbsp;the&nbsp;output&nbsp;of&nbsp;the&nbsp;py2dataset&nbsp;script.<br/>Requirements:<br/>[req01]&nbsp;The&nbsp;`read_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Read&nbsp;and&nbsp;return&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>[req02]&nbsp;The&nbsp;`write_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;dictionary&nbsp;and&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Write&nbsp;the&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;file&nbsp;in&nbsp;either&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;format.<br/>[req03]&nbsp;The&nbsp;`convert_json_to_html`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;each&nbsp;converted&nbsp;file&nbsp;with&nbsp;a&nbsp;.html&nbsp;extension.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Preserve&nbsp;spacing&nbsp;and&nbsp;tabs&nbsp;for&nbsp;the&nbsp;&#x27;input&#x27;&nbsp;field.<br/>[req04]&nbsp;The&nbsp;`combine_json_files`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;directory&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Merge&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Remove&nbsp;duplicates&nbsp;from&nbsp;the&nbsp;combined&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Write&nbsp;the&nbsp;combined&nbsp;data&nbsp;to&nbsp;&#x27;instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Convert&nbsp;the&nbsp;merged&nbsp;JSON&nbsp;files&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;Return&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>[req05]&nbsp;The&nbsp;`create_code_graph`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Generate&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;file&nbsp;details.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;graphs&nbsp;as&nbsp;PNG&nbsp;images&nbsp;in&nbsp;the&nbsp;specified&nbsp;output&nbsp;directory.<br/>[req06]&nbsp;The&nbsp;`save_python_data`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;the&nbsp;details&nbsp;of&nbsp;the&nbsp;Python&nbsp;file&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Generate&nbsp;and&nbsp;save&nbsp;code&nbsp;graphs.<br/>&quot;&quot;&quot;<br/>import&nbsp;sys<br/>import&nbsp;os<br/>import&nbsp;re<br/>import&nbsp;json<br/>import&nbsp;logging<br/>import&nbsp;yaml<br/>import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br/>import&nbsp;networkx&nbsp;as&nbsp;nx<br/>from&nbsp;html&nbsp;import&nbsp;escape<br/>from&nbsp;pathlib&nbsp;import&nbsp;Path<br/>from&nbsp;typing&nbsp;import&nbsp;Dict,&nbsp;List,&nbsp;Union<br/><br/><br/>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)<br/><br/><br/>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)<br/><br/><br/>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;JSON&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int&nbsp;=&nbsp;4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&quot;&nbsp;&quot;,&nbsp;&quot;&amp;nbsp;&quot;).replace(&quot;\t&quot;,&nbsp;&quot;&amp;nbsp;&quot;&nbsp;*&nbsp;tab_width)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;&nbsp;width:&nbsp;100%;&nbsp;table-layout:&nbsp;fixed;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;black;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding:&nbsp;8px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;left;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;white-space:&nbsp;pre-line;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vertical-align:&nbsp;top;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word-wrap:&nbsp;break-word;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_count&nbsp;=&nbsp;len(dataset[0].keys())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_width&nbsp;=&nbsp;100&nbsp;/&nbsp;column_count&nbsp;&nbsp;#&nbsp;Calculate&nbsp;the&nbsp;width&nbsp;for&nbsp;each&nbsp;column&nbsp;based&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;columns<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&nbsp;style=&#x27;width:&nbsp;{column_width}%;&#x27;&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;tr&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;\n&nbsp;to&nbsp;HTML&nbsp;line&nbsp;breaks<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;td&gt;{value}&lt;/td&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;/tr&gt;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))<br/><br/><br/>def&nbsp;combine_json_files(directory:&nbsp;str)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dictionary&nbsp;containing&nbsp;the&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;remove_duplicate_dataset_entries(dataset:&nbsp;List[Dict],&nbsp;key1:&nbsp;str,&nbsp;key2:&nbsp;str)&nbsp;-&gt;&nbsp;List[Dict]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;the&nbsp;provided&nbsp;dataset&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;(List[Dict]):&nbsp;The&nbsp;dataset&nbsp;to&nbsp;remove&nbsp;duplicates&nbsp;from.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key1&nbsp;(str):&nbsp;The&nbsp;first&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key2&nbsp;(str):&nbsp;The&nbsp;second&nbsp;key&nbsp;to&nbsp;check&nbsp;for&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;dataset&nbsp;without&nbsp;duplicate&nbsp;entries.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item[key1],&nbsp;item[key2])&nbsp;not&nbsp;in&nbsp;seen:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen.add((item[key1],&nbsp;item[key2]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name&nbsp;in&nbsp;[&#x27;instruct.json&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file_name<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file_name}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json_file_data&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(json_file_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;remove_duplicate_dataset_entries(combined_data,&nbsp;&#x27;instruction&#x27;,&nbsp;&#x27;output&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gen&nbsp;training&nbsp;datasets&nbsp;that&nbsp;contains&nbsp;purpose&nbsp;and&nbsp;graph&nbsp;data&nbsp;formatted&nbsp;as&nbsp;follow&nbsp;for&nbsp;each&nbsp;item&nbsp;in&nbsp;the&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;1)&nbsp;Describe&nbsp;the&nbsp;purpose&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_data&nbsp;=&nbsp;[item&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data&nbsp;if&nbsp;item[&#x27;instruction&#x27;].startswith(&#x27;What&nbsp;is&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&#x27;)]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;Python&nbsp;code&nbsp;file&nbsp;that&nbsp;is&nbsp;described&nbsp;as&nbsp;follows:\n&#x27;+&nbsp;item[&#x27;output&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;input&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;graph_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;graph_output.append({&#x27;instruction&#x27;:&nbsp;&#x27;Define&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&nbsp;for&nbsp;Python&nbsp;file:\n&#x27;&nbsp;+&nbsp;item[&#x27;input&#x27;],&nbsp;&#x27;output&#x27;:&nbsp;item[&#x27;output&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_graph_output&nbsp;=&nbsp;code_output&nbsp;+&nbsp;graph_output<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(code_graph_output,&nbsp;Path(directory)&nbsp;/&nbsp;&#x27;training.json&#x27;)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Save&nbsp;html&nbsp;file&nbsp;for&nbsp;each&nbsp;json&nbsp;file&nbsp;in&nbsp;the&nbsp;output&nbsp;directory<br/>&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;instruct_list&#x27;:&nbsp;instruct_data}<br/><br/><br/>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;graph_type&nbsp;=&nbsp;&#x27;entire_code_graph&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;graphs,&nbsp;add&nbsp;nodes,&nbsp;and&nbsp;add&nbsp;edges<br/>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;G.add_nodes_from(file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source,&nbsp;target&nbsp;=&nbsp;edge[&#x27;source&#x27;],&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**{k:&nbsp;v&nbsp;for&nbsp;k,&nbsp;v&nbsp;in&nbsp;edge.items()&nbsp;if&nbsp;k&nbsp;in&nbsp;[&#x27;target_inputs&#x27;,&nbsp;&#x27;target_returns&#x27;]})<br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Draw&nbsp;graphs<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size&nbsp;=&nbsp;8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[(edge[0],&nbsp;edge[1])]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)&nbsp;#&nbsp;Save&nbsp;the&nbsp;figure<br/>&nbsp;&nbsp;&nbsp;&nbsp;plt.close()&nbsp;&nbsp;#&nbsp;Close&nbsp;the&nbsp;figure<br/><br/><br/>def&nbsp;save_python_data(file_details:&nbsp;dict,&nbsp;instruct_list:&nbsp;list,&nbsp;relative_path:&nbsp;Path,&nbsp;output_dir:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Save&nbsp;Python&nbsp;file&nbsp;details&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file,&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;a&nbsp;JSON&nbsp;file,&nbsp;and&nbsp;code&nbsp;graphs.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_list&nbsp;(list):&nbsp;The&nbsp;instruction&nbsp;data&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relative_path&nbsp;(Path):&nbsp;The&nbsp;relative&nbsp;path&nbsp;to&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_dir&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;=&nbsp;Path(output_dir)&nbsp;/&nbsp;relative_path.parts[0]<br/>&nbsp;&nbsp;&nbsp;&nbsp;output_subdir.mkdir(parents=True,&nbsp;exist_ok=True)<br/>&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;=&nbsp;&#x27;.&#x27;.join(part&nbsp;for&nbsp;part&nbsp;in&nbsp;relative_path.parts)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;write&nbsp;instrunct.json&nbsp;files<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[f&#x27;{base_name}.instruct.json&#x27;,&nbsp;f&#x27;{base_name}.details.yaml&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;contents&nbsp;=&nbsp;[instruct_list,&nbsp;file_details]<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file_name,&nbsp;content&nbsp;in&nbsp;zip(file_names,&nbsp;contents):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(content,&nbsp;output_subdir&nbsp;/&nbsp;file_name)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create_code_graph(file_details,&nbsp;base_name,&nbsp;output_subdir)<br/>&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.info(f&#x27;Error&nbsp;creating&nbsp;graph&nbsp;for&nbsp;{base_name}&#x27;)<br/></td><td>The&nbsp;purpose&nbsp;of&nbsp;this&nbsp;Python&nbsp;file&nbsp;is&nbsp;to&nbsp;provide&nbsp;utility&nbsp;functions&nbsp;for&nbsp;reading&nbsp;the&nbsp;input&nbsp;and&nbsp;saving&nbsp;the&nbsp;output&nbsp;of&nbsp;the&nbsp;py2dataset&nbsp;script.&nbsp;It&nbsp;includes&nbsp;functions&nbsp;such&nbsp;as&nbsp;read_file(),&nbsp;write_file(),&nbsp;convert_json_to_html(),&nbsp;combine_json_files(),&nbsp;create_code_graph(),&nbsp;and&nbsp;save_python_data().&nbsp;The&nbsp;functions&nbsp;are&nbsp;used&nbsp;to&nbsp;read&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;files,&nbsp;convert&nbsp;JSON&nbsp;files&nbsp;to&nbsp;HTML&nbsp;format,&nbsp;merge&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;a&nbsp;given&nbsp;directory,&nbsp;remove&nbsp;duplicates&nbsp;from&nbsp;the&nbsp;combined&nbsp;JSON&nbsp;files,&nbsp;write&nbsp;the&nbsp;data&nbsp;as&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;files,&nbsp;generate&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;provided&nbsp;file&nbsp;details,&nbsp;and&nbsp;save&nbsp;Python&nbsp;file&nbsp;details&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file.<br/><br/>1.&nbsp;read_file()&nbsp;-&nbsp;This&nbsp;function&nbsp;reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.&nbsp;It&nbsp;takes&nbsp;in&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;an&nbsp;argument&nbsp;and&nbsp;opens&nbsp;the&nbsp;file&nbsp;using&nbsp;the&nbsp;appropriate&nbsp;method&nbsp;(json.load()&nbsp;for&nbsp;JSON&nbsp;files&nbsp;and&nbsp;yaml.load()&nbsp;for&nbsp;YAML&nbsp;files)&nbsp;to&nbsp;load&nbsp;the&nbsp;data&nbsp;into&nbsp;a&nbsp;Python&nbsp;dictionary.<br/>2.&nbsp;write_file()&nbsp;-&nbsp;This&nbsp;function&nbsp;writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;It&nbsp;takes&nbsp;in&nbsp;two&nbsp;arguments,&nbsp;&quot;data&quot;&nbsp;as&nbsp;a&nbsp;dictionary&nbsp;containing&nbsp;the&nbsp;information&nbsp;that&nbsp;needs&nbsp;to&nbsp;be&nbsp;written&nbsp;and&nbsp;&quot;file_path&quot;&nbsp;as&nbsp;the&nbsp;path&nbsp;to&nbsp;the&nbsp;output&nbsp;file.&nbsp;The&nbsp;appropriate&nbsp;method&nbsp;(json.dump()&nbsp;for&nbsp;JSON&nbsp;files&nbsp;and&nbsp;yaml.safe_dump())&nbsp;is&nbsp;used&nbsp;to&nbsp;write&nbsp;the&nbsp;data&nbsp;to&nbsp;the&nbsp;file&nbsp;with&nbsp;proper&nbsp;indentation&nbsp;and&nbsp;spacing.<br/>3.&nbsp;convert_json_to_html()&nbsp;-&nbsp;This&nbsp;function&nbsp;converts&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;a&nbsp;given&nbsp;directory&nbsp;into&nbsp;HTML&nbsp;format&nbsp;while&nbsp;preserving&nbsp;spacing&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;&quot;input&quot;&nbsp;field.&nbsp;It&nbsp;first&nbsp;searches&nbsp;for&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;provided&nbsp;directory&nbsp;using&nbsp;pathlib.Path.rglob()&nbsp;and&nbsp;loops&nbsp;through&nbsp;them&nbsp;to&nbsp;load&nbsp;their&nbsp;content.&nbsp;It&nbsp;then&nbsp;converts&nbsp;each&nbsp;dictionary&nbsp;of&nbsp;entries&nbsp;into&nbsp;an&nbsp;HTML&nbsp;table&nbsp;with&nbsp;appropriate&nbsp;CSS&nbsp;styles&nbsp;and&nbsp;saves&nbsp;it&nbsp;as&nbsp;a&nbsp;.html&nbsp;file.<br/>4.&nbsp;combine_json_files()&nbsp;-&nbsp;This&nbsp;function&nbsp;combines&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&quot;instruct.json&quot;&nbsp;and&nbsp;removes&nbsp;duplicates&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;keys&nbsp;(&quot;instruction&quot;&nbsp;and&nbsp;&quot;output&quot;).&nbsp;It&nbsp;first&nbsp;creates&nbsp;an&nbsp;empty&nbsp;list&nbsp;called&nbsp;&quot;combined_data&quot;.&nbsp;Then,&nbsp;it&nbsp;loops&nbsp;through&nbsp;each&nbsp;JSON&nbsp;file&nbsp;in&nbsp;the&nbsp;directory&nbsp;using&nbsp;pathlib.Path.rglob()&nbsp;to&nbsp;load&nbsp;its&nbsp;content&nbsp;into&nbsp;a&nbsp;dictionary&nbsp;called&nbsp;&quot;json_file_data&quot;.&nbsp;The&nbsp;function&nbsp;then&nbsp;uses&nbsp;remove_duplicate_dataset_entries()&nbsp;to&nbsp;filter&nbsp;out&nbsp;duplicates&nbsp;from&nbsp;combined_data&nbsp;based&nbsp;on&nbsp;two&nbsp;keys&nbsp;(&quot;instruction&quot;&nbsp;and&nbsp;&quot;output&quot;)&nbsp;before&nbsp;writing&nbsp;it&nbsp;back&nbsp;to&nbsp;instruct.json&nbsp;file.&nbsp;Additionally,&nbsp;it&nbsp;generates&nbsp;training&nbsp;data&nbsp;that&nbsp;contains&nbsp;purpose&nbsp;and&nbsp;graph&nbsp;data&nbsp;formatted&nbsp;as&nbsp;follow&nbsp;for&nbsp;each&nbsp;item&nbsp;in&nbsp;the&nbsp;dataset&nbsp;by&nbsp;extracting&nbsp;specific&nbsp;entries&nbsp;with&nbsp;regex&nbsp;pattern&nbsp;matching.&nbsp;Finally,&nbsp;it&nbsp;calls&nbsp;convert_json_to_html()&nbsp;function&nbsp;to&nbsp;save&nbsp;HTML&nbsp;files&nbsp;for&nbsp;each&nbsp;JSON&nbsp;file&nbsp;in&nbsp;the&nbsp;output&nbsp;directory.<br/>5.&nbsp;remove_duplicate_dataset_entries()&nbsp;-&nbsp;This&nbsp;function&nbsp;removes&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;a&nbsp;provided&nbsp;list&nbsp;of&nbsp;dictionaries&nbsp;based&nbsp;on&nbsp;two&nbsp;keys&nbsp;(&quot;instruction&quot;&nbsp;and&nbsp;&quot;output&quot;).&nbsp;It&nbsp;initializes&nbsp;an&nbsp;empty&nbsp;set&nbsp;called&nbsp;&quot;seen&quot;,&nbsp;an&nbsp;empty&nbsp;list&nbsp;called&nbsp;&quot;result&quot;.&nbsp;Then,&nbsp;it&nbsp;loops&nbsp;through&nbsp;each&nbsp;item&nbsp;in&nbsp;the&nbsp;dataset&nbsp;and&nbsp;checks&nbsp;if&nbsp;the&nbsp;tuple&nbsp;(item[&quot;instruction&quot;],&nbsp;item[&quot;output&quot;])&nbsp;is&nbsp;already&nbsp;present&nbsp;in&nbsp;seen.&nbsp;If&nbsp;not,&nbsp;it&nbsp;adds&nbsp;it&nbsp;to&nbsp;both&nbsp;seen&nbsp;and&nbsp;result&nbsp;sets.&nbsp;The&nbsp;function&nbsp;returns&nbsp;a&nbsp;list&nbsp;without&nbsp;duplicate&nbsp;entries&nbsp;based&nbsp;on&nbsp;those&nbsp;two&nbsp;keys.<br/>6.&nbsp;create_code_graph()&nbsp;-&nbsp;This&nbsp;function&nbsp;takes&nbsp;&quot;file_details&quot;,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments&nbsp;and&nbsp;generates&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;file&nbsp;details&nbsp;using&nbsp;networkx&nbsp;library.&nbsp;It&nbsp;creates&nbsp;a&nbsp;directed&nbsp;graph&nbsp;(DiGraph)&nbsp;called&nbsp;G,&nbsp;adds&nbsp;nodes&nbsp;from&nbsp;&quot;file_info&quot;[&quot;nodes&quot;],&nbsp;and&nbsp;then&nbsp;loops&nbsp;through&nbsp;each&nbsp;edge&nbsp;in&nbsp;&quot;file_info&quot;[&quot;edges&quot;]&nbsp;to&nbsp;add&nbsp;edges&nbsp;with&nbsp;their&nbsp;respective&nbsp;inputs&nbsp;and&nbsp;returns.&nbsp;The&nbsp;function&nbsp;then&nbsp;uses&nbsp;nx.draw()&nbsp;to&nbsp;draw&nbsp;the&nbsp;graph,&nbsp;labels&nbsp;the&nbsp;edges&nbsp;based&nbsp;on&nbsp;input&nbsp;and&nbsp;return&nbsp;values,&nbsp;and&nbsp;saves&nbsp;it&nbsp;as&nbsp;a&nbsp;PNG&nbsp;image&nbsp;using&nbsp;plt.savefig().<br/>7.&nbsp;save_python_data()&nbsp;-&nbsp;This&nbsp;function&nbsp;takes&nbsp;&quot;file_details&quot;,&nbsp;&quot;instruct_list&quot;,&nbsp;&quot;relative_path&quot;,&nbsp;and&nbsp;&quot;output_dir&quot;&nbsp;as&nbsp;arguments&nbsp;and&nbsp;saves&nbsp;Python&nbsp;file&nbsp;details&nbsp;as&nbsp;a&nbsp;YAML&nbsp;file,&nbsp;the&nbsp;instruction&nbsp;data&nbsp;as&nbsp;a&nbsp;JSON&nbsp;file,&nbsp;and&nbsp;code&nbsp;graphs.&nbsp;It&nbsp;first&nbsp;creates&nbsp;an&nbsp;output&nbsp;directory&nbsp;using&nbsp;pathlib.Path().mkdir()&nbsp;method&nbsp;if&nbsp;it&nbsp;does&nbsp;not&nbsp;exist.&nbsp;Then,&nbsp;it&nbsp;loops&nbsp;through&nbsp;each&nbsp;entry&nbsp;in&nbsp;instruct_list&nbsp;and&nbsp;generates&nbsp;two&nbsp;different&nbsp;JSON&nbsp;files&nbsp;(&quot;details&quot;&nbsp;and&nbsp;&quot;instruct&quot;)&nbsp;by&nbsp;filtering&nbsp;entries&nbsp;that&nbsp;start&nbsp;with&nbsp;specific&nbsp;patterns&nbsp;(1)&nbsp;Describe&nbsp;the&nbsp;Python&nbsp;code&nbsp;file&nbsp;that&nbsp;is&nbsp;described&nbsp;as&nbsp;follows:&nbsp;and&nbsp;What&nbsp;is&nbsp;the&nbsp;call&nbsp;code&nbsp;graph&nbsp;for&nbsp;Python&nbsp;file:).&nbsp;It&nbsp;also&nbsp;calls&nbsp;create_code_graph()&nbsp;to&nbsp;generate&nbsp;a&nbsp;PNG&nbsp;image&nbsp;of&nbsp;the&nbsp;entire&nbsp;code&nbsp;graph.<br/>8.&nbsp;The&nbsp;function&nbsp;read_file()&nbsp;takes&nbsp;in&nbsp;a&nbsp;&quot;file_path&quot;&nbsp;argument,&nbsp;checks&nbsp;its&nbsp;extension&nbsp;using&nbsp;file_path.suffix[1:]&nbsp;(i.e.,&nbsp;&#x27;json&#x27;&nbsp;or&nbsp;&#x27;yaml&#x27;)&nbsp;and&nbsp;loads&nbsp;it&nbsp;accordingly&nbsp;with&nbsp;either&nbsp;json.load()&nbsp;or&nbsp;yaml.load().&nbsp;It&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>9.&nbsp;The&nbsp;function&nbsp;write_file()&nbsp;takes&nbsp;in&nbsp;two&nbsp;arguments,&nbsp;&quot;data&quot;&nbsp;as&nbsp;a&nbsp;dictionary&nbsp;containing&nbsp;the&nbsp;information&nbsp;that&nbsp;needs&nbsp;to&nbsp;be&nbsp;written&nbsp;and&nbsp;&quot;file_path&quot;&nbsp;as&nbsp;the&nbsp;path&nbsp;to&nbsp;the&nbsp;output&nbsp;file.&nbsp;It&nbsp;uses&nbsp;appropriate&nbsp;methods&nbsp;(json.dump()&nbsp;for&nbsp;JSON&nbsp;files&nbsp;and&nbsp;yaml.safe_dump())&nbsp;to&nbsp;write&nbsp;the&nbsp;data&nbsp;to&nbsp;the&nbsp;file&nbsp;with&nbsp;proper&nbsp;indentation&nbsp;and&nbsp;spacing.<br/>10.&nbsp;The&nbsp;function&nbsp;preserve_spacing()&nbsp;takes&nbsp;in&nbsp;a&nbsp;&quot;text&quot;&nbsp;argument&nbsp;and&nbsp;preserves&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;while&nbsp;converting&nbsp;it&nbsp;into&nbsp;HTML&nbsp;format&nbsp;by&nbsp;replacing&nbsp;spaces&nbsp;with&nbsp;&amp;nbsp;&nbsp;and&nbsp;tabs&nbsp;with&nbsp;&amp;nbsp;&nbsp;*&nbsp;tab_width&nbsp;(default&nbsp;4).<br/><br/>Reasons&nbsp;to&nbsp;follow:&nbsp;The&nbsp;requirements&nbsp;from&nbsp;the&nbsp;code&nbsp;problem&nbsp;indicate&nbsp;that&nbsp;read_file&nbsp;should&nbsp;open&nbsp;either&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;using&nbsp;an&nbsp;appropriate&nbsp;loader.&nbsp;Therefore,&nbsp;&quot;try-except&quot;&nbsp;blocks&nbsp;are&nbsp;added&nbsp;around&nbsp;the&nbsp;two&nbsp;possible&nbsp;load&nbsp;methods&nbsp;for&nbsp;different&nbsp;types&nbsp;of&nbsp;files&nbsp;and&nbsp;it&nbsp;will&nbsp;use&nbsp;json.load()&nbsp;if&nbsp;it&nbsp;is&nbsp;unable&nbsp;to&nbsp;load&nbsp;with&nbsp;yaml.load().&nbsp;Additionally,&nbsp;it&nbsp;has&nbsp;some&nbsp;comments&nbsp;and&nbsp;indentation&nbsp;rules&nbsp;in&nbsp;line&nbsp;59&nbsp;and&nbsp;62.&nbsp;write_file&nbsp;uses&nbsp;both&nbsp;SafeDumper&nbsp;from&nbsp;PyYAML&nbsp;to&nbsp;preserve&nbsp;the&nbsp;order&nbsp;of&nbsp;dictionaries&nbsp;and&nbsp;indent=4&nbsp;for&nbsp;JSON&nbsp;files.&nbsp;The&nbsp;function&nbsp;convert_json_to_html()&nbsp;is&nbsp;used&nbsp;to&nbsp;generate&nbsp;HTML&nbsp;tables&nbsp;from&nbsp;JSON&nbsp;files&nbsp;while&nbsp;preserving&nbsp;spacing&nbsp;and&nbsp;tabs,&nbsp;which&nbsp;are&nbsp;replaced&nbsp;with&nbsp;&amp;nbsp;&nbsp;and&nbsp;&lt;br/&gt;&nbsp;tags&nbsp;respectively.&nbsp;It&nbsp;also&nbsp;uses&nbsp;pathlib.Path.rglob()&nbsp;to&nbsp;search&nbsp;for&nbsp;all&nbsp;.json&nbsp;files&nbsp;in&nbsp;a&nbsp;given&nbsp;directory,&nbsp;as&nbsp;specified&nbsp;in&nbsp;the&nbsp;problem&nbsp;requirements.<br/>The&nbsp;function&nbsp;remove_duplicate_dataset_entries()&nbsp;removes&nbsp;duplicate&nbsp;entries&nbsp;from&nbsp;&quot;dataset&quot;&nbsp;by&nbsp;iterating&nbsp;over&nbsp;each&nbsp;item&nbsp;in&nbsp;the&nbsp;list&nbsp;and&nbsp;checking&nbsp;if&nbsp;its&nbsp;(instruction,&nbsp;output)&nbsp;tuple&nbsp;is&nbsp;already&nbsp;present&nbsp;in&nbsp;&quot;seen&quot;,&nbsp;an&nbsp;empty&nbsp;set.&nbsp;It&nbsp;adds&nbsp;the&nbsp;new&nbsp;items&nbsp;to&nbsp;&quot;result&quot;&nbsp;if&nbsp;it&nbsp;is&nbsp;not&nbsp;a&nbsp;duplicate&nbsp;and&nbsp;returns&nbsp;the&nbsp;updated&nbsp;list.&nbsp;The&nbsp;function&nbsp;then&nbsp;filters&nbsp;out&nbsp;purpose&nbsp;and&nbsp;graph&nbsp;data&nbsp;from&nbsp;instruct_list,&nbsp;which&nbsp;is&nbsp;combined&nbsp;with&nbsp;code&nbsp;data&nbsp;using&nbsp;regex&nbsp;patterns&nbsp;and&nbsp;saved&nbsp;as&nbsp;training.json&nbsp;file.<br/>The&nbsp;function&nbsp;create_code_graph()&nbsp;takes&nbsp;in&nbsp;&quot;file_details&quot;,&nbsp;&quot;base_name&quot;,&nbsp;and&nbsp;&quot;output_subdir&quot;&nbsp;to&nbsp;generate&nbsp;call&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;information&nbsp;using&nbsp;networkx&nbsp;library&nbsp;and&nbsp;save&nbsp;it&nbsp;as&nbsp;a&nbsp;PNG&nbsp;image&nbsp;using&nbsp;plt.savefig().&nbsp;The&nbsp;base&nbsp;name&nbsp;is&nbsp;used&nbsp;to&nbsp;create&nbsp;a&nbsp;unique&nbsp;file&nbsp;name&nbsp;for&nbsp;each&nbsp;graph.<br/>The&nbsp;function&nbsp;save_python_data()&nbsp;takes&nbsp;in&nbsp;&quot;file_details&quot;,&nbsp;&quot;instruct_list&quot;,&nbsp;&quot;relative_path&quot;&nbsp;(as&nbsp;str),&nbsp;and&nbsp;&quot;output_dir&quot;.&nbsp;It&nbsp;uses&nbsp;Path()&nbsp;method&nbsp;to&nbsp;create&nbsp;an&nbsp;output&nbsp;directory&nbsp;if&nbsp;it&nbsp;does&nbsp;not&nbsp;exist,&nbsp;and&nbsp;then&nbsp;creates&nbsp;two&nbsp;JSON&nbsp;files:&nbsp;details.json&nbsp;and&nbsp;instruct.json.&nbsp;It&nbsp;also&nbsp;calls&nbsp;create_code_graph()&nbsp;to&nbsp;generate&nbsp;PNG&nbsp;images&nbsp;of&nbsp;the&nbsp;entire&nbsp;code&nbsp;graph&nbsp;and&nbsp;saves&nbsp;them&nbsp;in&nbsp;the&nbsp;same&nbsp;directory&nbsp;as&nbsp;instruct.json.<br/>Variables:&nbsp;<br/>-&nbsp;file_type&nbsp;(str):&nbsp;The&nbsp;type&nbsp;of&nbsp;file&nbsp;based&nbsp;on&nbsp;its&nbsp;extension&nbsp;(either&nbsp;&#x27;yaml&#x27;&nbsp;or&nbsp;&#x27;json&#x27;)<br/>-&nbsp;html_content&nbsp;(str):&nbsp;The&nbsp;HTML&nbsp;content&nbsp;for&nbsp;each&nbsp;table,&nbsp;including&nbsp;CSS&nbsp;styles&nbsp;and&nbsp;headers<br/>-&nbsp;column_count&nbsp;(int):&nbsp;The&nbsp;number&nbsp;of&nbsp;columns&nbsp;in&nbsp;the&nbsp;&quot;input&quot;&nbsp;and&nbsp;&quot;output&quot;&nbsp;data&nbsp;tables,&nbsp;to&nbsp;set&nbsp;fixed&nbsp;width&nbsp;for&nbsp;them&nbsp;as&nbsp;1/3&nbsp;and&nbsp;2/3.&nbsp;It&nbsp;will&nbsp;help&nbsp;determine&nbsp;column_width<br/>-&nbsp;html_file&nbsp;(Path):&nbsp;The&nbsp;output&nbsp;file&nbsp;path&nbsp;with&nbsp;a&nbsp;.html&nbsp;extension<br/>-&nbsp;seen&nbsp;(set):&nbsp;A&nbsp;set&nbsp;used&nbsp;to&nbsp;store&nbsp;unique&nbsp;(instruction,&nbsp;output)&nbsp;tuples&nbsp;to&nbsp;avoid&nbsp;duplicates&nbsp;in&nbsp;&quot;combine_json_files()&quot;&nbsp;function<br/>-&nbsp;dataset&nbsp;(list):&nbsp;The&nbsp;list&nbsp;of&nbsp;dictionaries&nbsp;extracted&nbsp;from&nbsp;each&nbsp;JSON&nbsp;file,&nbsp;contains&nbsp;&#x27;instruct&#x27;,&nbsp;&#x27;output&#x27;,&nbsp;and&nbsp;other&nbsp;information&nbsp;such&nbsp;as&nbsp;call&nbsp;nodes/edges&nbsp;for&nbsp;creating&nbsp;a&nbsp;code&nbsp;graph<br/>-&nbsp;pos:&nbsp;the&nbsp;node&nbsp;positions&nbsp;determined&nbsp;by&nbsp;nx.spring_layout()&nbsp;function&nbsp;used&nbsp;to&nbsp;position&nbsp;the&nbsp;nodes&nbsp;on&nbsp;the&nbsp;network&nbsp;plot.<br/>-&nbsp;result&nbsp;(list):&nbsp;An&nbsp;empty&nbsp;list&nbsp;of&nbsp;combined&nbsp;JSON&nbsp;data&nbsp;from&nbsp;multiple&nbsp;files<br/>-&nbsp;edge_labels&nbsp;(dict):&nbsp;A&nbsp;dictionary&nbsp;that&nbsp;maps&nbsp;edges&nbsp;to&nbsp;their&nbsp;respective&nbsp;input&nbsp;and&nbsp;return&nbsp;values,&nbsp;for&nbsp;displaying&nbsp;them&nbsp;as&nbsp;labels&nbsp;in&nbsp;the&nbsp;graph<br/>-&nbsp;output_file&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;where&nbsp;the&nbsp;PNG&nbsp;image&nbsp;will&nbsp;be&nbsp;saved</td></tr>
                </tbody>
            </table>
        </body>
        </html>
        