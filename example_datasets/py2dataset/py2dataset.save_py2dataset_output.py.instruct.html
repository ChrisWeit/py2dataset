
        <html>
        <head>
            <style>
                table {border-collapse: collapse;width: 100%;}
                th, td {border: 1px solid black; padding: 8px; text-align: left; white-space: pre-line;}
                td:nth-child(2) { width: 50%; overflow-wrap: anywhere;}
            </style>
        </head>
        <body>
            <table>
                <thead>
                    <tr>
        <th>instruction</th><th>input</th><th>output</th>
                    </tr>
                </thead>
                <tbody>
        <tr><td>What are the dependencies of the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>&quot;&quot;&quot;<br/>Requirements:<br/>[req01]&nbsp;The&nbsp;`read_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Read&nbsp;and&nbsp;return&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>[req02]&nbsp;The&nbsp;`write_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;dictionary&nbsp;and&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Write&nbsp;the&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;file&nbsp;in&nbsp;either&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;format.<br/>[req03]&nbsp;The&nbsp;`convert_json_to_html`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;each&nbsp;converted&nbsp;file&nbsp;with&nbsp;a&nbsp;.html&nbsp;extension.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Preserve&nbsp;spacing&nbsp;and&nbsp;tabs&nbsp;for&nbsp;the&nbsp;&#x27;input&#x27;&nbsp;field.<br/>[req04]&nbsp;The&nbsp;`combine_json_files`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;directory&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Merge&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Remove&nbsp;duplicates&nbsp;from&nbsp;the&nbsp;combined&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Write&nbsp;the&nbsp;combined&nbsp;data&nbsp;to&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;&#x27;instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Generate&nbsp;and&nbsp;save&nbsp;&#x27;qa_purpose.json&#x27;,&nbsp;&#x27;qa_instruct.json&#x27;,&nbsp;and&nbsp;&#x27;qa_cleaned_instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;Convert&nbsp;the&nbsp;merged&nbsp;JSON&nbsp;files&nbsp;to&nbsp;HTML&nbsp;format&nbsp;if&nbsp;the&nbsp;html&nbsp;flag&nbsp;is&nbsp;set&nbsp;to&nbsp;True.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.&nbsp;Return&nbsp;the&nbsp;&#x27;qa_list&#x27;&nbsp;and&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>[req05]&nbsp;The&nbsp;`create_code_graph`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Generate&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;file&nbsp;details.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;graphs&nbsp;as&nbsp;PNG&nbsp;images&nbsp;in&nbsp;the&nbsp;specified&nbsp;output&nbsp;directory.<br/>&quot;&quot;&quot;<br/>import&nbsp;sys<br/>import&nbsp;os<br/>import&nbsp;re<br/>import&nbsp;json<br/>import&nbsp;logging<br/>import&nbsp;yaml<br/>import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br/>import&nbsp;networkx&nbsp;as&nbsp;nx<br/>from&nbsp;html&nbsp;import&nbsp;escape<br/>from&nbsp;pathlib&nbsp;import&nbsp;Path<br/>from&nbsp;typing&nbsp;import&nbsp;Dict,&nbsp;List,&nbsp;Union<br/><br/><br/>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)<br/><br/><br/>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)<br/><br/><br/>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int&nbsp;=&nbsp;4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&quot;&nbsp;&quot;,&nbsp;&quot;&amp;nbsp;&quot;).replace(&quot;\t&quot;,&nbsp;&quot;&amp;nbsp;&quot;&nbsp;*&nbsp;tab_width)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;width:&nbsp;100%;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{border:&nbsp;1px&nbsp;solid&nbsp;black;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;left;&nbsp;white-space:&nbsp;pre-line;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;td:nth-child(2)&nbsp;{&nbsp;width:&nbsp;50%;&nbsp;overflow-wrap:&nbsp;anywhere;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;tr&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;\n&nbsp;to&nbsp;HTML&nbsp;line&nbsp;breaks<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;key&nbsp;==&nbsp;&quot;input&quot;:&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;td&gt;{value}&lt;/td&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;/tr&gt;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))<br/><br/><br/>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;purpose-specific&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Reset&nbsp;combined_data&nbsp;for&nbsp;the&nbsp;next&nbsp;iteration<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;remove&nbsp;duplicate&nbsp;&quot;input&quot;&nbsp;info&nbsp;in&nbsp;the&nbsp;instruct.json&nbsp;and&nbsp;instruct_purpose.json&nbsp;information&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;to&nbsp;make&nbsp;a&nbsp;cleaned_instruct.json&nbsp;cleaned_instruct_purpose_json<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;+&nbsp;file)&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;save&nbsp;html&nbsp;file&nbsp;for&nbsp;each&nbsp;json&nbsp;file&nbsp;in&nbsp;the&nbsp;output&nbsp;directory<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}<br/><br/><br/>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;graph_type&nbsp;in&nbsp;[&#x27;internal_code_graph&#x27;,&nbsp;&#x27;entire_code_graph&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;graphs<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node_name&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_node(node_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Add&nbsp;edges<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;=&nbsp;edge[&#x27;source&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_inputs&#x27;]&nbsp;=&nbsp;edge[&#x27;target_inputs&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_returns&#x27;]&nbsp;=&nbsp;edge[&#x27;target_returns&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**edge_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Save&nbsp;code&nbsp;graph&nbsp;as&nbsp;png<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size&nbsp;=&nbsp;8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[(edge[0],&nbsp;edge[1])]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()&nbsp;&nbsp;#&nbsp;Close&nbsp;the&nbsp;figure</td><td>networkx, logging, sys, os, json, re, typing, yaml, html, matplotlib.pyplot, pathlib</td></tr><tr><td>What are the structural relationships between the functions and classes defined in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>&quot;&quot;&quot;<br/>Requirements:<br/>[req01]&nbsp;The&nbsp;`read_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Read&nbsp;and&nbsp;return&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>[req02]&nbsp;The&nbsp;`write_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;dictionary&nbsp;and&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Write&nbsp;the&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;file&nbsp;in&nbsp;either&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;format.<br/>[req03]&nbsp;The&nbsp;`convert_json_to_html`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;each&nbsp;converted&nbsp;file&nbsp;with&nbsp;a&nbsp;.html&nbsp;extension.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Preserve&nbsp;spacing&nbsp;and&nbsp;tabs&nbsp;for&nbsp;the&nbsp;&#x27;input&#x27;&nbsp;field.<br/>[req04]&nbsp;The&nbsp;`combine_json_files`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;directory&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Merge&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Remove&nbsp;duplicates&nbsp;from&nbsp;the&nbsp;combined&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Write&nbsp;the&nbsp;combined&nbsp;data&nbsp;to&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;&#x27;instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Generate&nbsp;and&nbsp;save&nbsp;&#x27;qa_purpose.json&#x27;,&nbsp;&#x27;qa_instruct.json&#x27;,&nbsp;and&nbsp;&#x27;qa_cleaned_instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;Convert&nbsp;the&nbsp;merged&nbsp;JSON&nbsp;files&nbsp;to&nbsp;HTML&nbsp;format&nbsp;if&nbsp;the&nbsp;html&nbsp;flag&nbsp;is&nbsp;set&nbsp;to&nbsp;True.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.&nbsp;Return&nbsp;the&nbsp;&#x27;qa_list&#x27;&nbsp;and&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>[req05]&nbsp;The&nbsp;`create_code_graph`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Generate&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;file&nbsp;details.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;graphs&nbsp;as&nbsp;PNG&nbsp;images&nbsp;in&nbsp;the&nbsp;specified&nbsp;output&nbsp;directory.<br/>&quot;&quot;&quot;<br/>import&nbsp;sys<br/>import&nbsp;os<br/>import&nbsp;re<br/>import&nbsp;json<br/>import&nbsp;logging<br/>import&nbsp;yaml<br/>import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br/>import&nbsp;networkx&nbsp;as&nbsp;nx<br/>from&nbsp;html&nbsp;import&nbsp;escape<br/>from&nbsp;pathlib&nbsp;import&nbsp;Path<br/>from&nbsp;typing&nbsp;import&nbsp;Dict,&nbsp;List,&nbsp;Union<br/><br/><br/>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)<br/><br/><br/>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)<br/><br/><br/>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int&nbsp;=&nbsp;4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&quot;&nbsp;&quot;,&nbsp;&quot;&amp;nbsp;&quot;).replace(&quot;\t&quot;,&nbsp;&quot;&amp;nbsp;&quot;&nbsp;*&nbsp;tab_width)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;width:&nbsp;100%;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{border:&nbsp;1px&nbsp;solid&nbsp;black;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;left;&nbsp;white-space:&nbsp;pre-line;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;td:nth-child(2)&nbsp;{&nbsp;width:&nbsp;50%;&nbsp;overflow-wrap:&nbsp;anywhere;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;tr&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;\n&nbsp;to&nbsp;HTML&nbsp;line&nbsp;breaks<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;key&nbsp;==&nbsp;&quot;input&quot;:&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;td&gt;{value}&lt;/td&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;/tr&gt;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))<br/><br/><br/>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;purpose-specific&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Reset&nbsp;combined_data&nbsp;for&nbsp;the&nbsp;next&nbsp;iteration<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;remove&nbsp;duplicate&nbsp;&quot;input&quot;&nbsp;info&nbsp;in&nbsp;the&nbsp;instruct.json&nbsp;and&nbsp;instruct_purpose.json&nbsp;information&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;to&nbsp;make&nbsp;a&nbsp;cleaned_instruct.json&nbsp;cleaned_instruct_purpose_json<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;+&nbsp;file)&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;save&nbsp;html&nbsp;file&nbsp;for&nbsp;each&nbsp;json&nbsp;file&nbsp;in&nbsp;the&nbsp;output&nbsp;directory<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}<br/><br/><br/>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;graph_type&nbsp;in&nbsp;[&#x27;internal_code_graph&#x27;,&nbsp;&#x27;entire_code_graph&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;graphs<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node_name&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_node(node_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Add&nbsp;edges<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;=&nbsp;edge[&#x27;source&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_inputs&#x27;]&nbsp;=&nbsp;edge[&#x27;target_inputs&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_returns&#x27;]&nbsp;=&nbsp;edge[&#x27;target_returns&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**edge_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Save&nbsp;code&nbsp;graph&nbsp;as&nbsp;png<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size&nbsp;=&nbsp;8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[(edge[0],&nbsp;edge[1])]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()&nbsp;&nbsp;#&nbsp;Close&nbsp;the&nbsp;figure</td><td>{&#x27;nodes&#x27;: [&#x27;read_file&#x27;, &#x27;write_file&#x27;, &#x27;convert_json_to_html&#x27;, &#x27;preserve_spacing&#x27;, &#x27;combine_json_files&#x27;, &#x27;create_code_graph&#x27;], &#x27;edges&#x27;: [{&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;preserve_spacing&#x27;, &#x27;target_inputs&#x27;: [&#x27;text&#x27;, &#x27;tab_width&#x27;], &#x27;target_returns&#x27;: [&quot;text.replace(&#x27; &#x27;, &#x27;&amp;nbsp;&#x27;).replace(&#x27;\\t&#x27;, &#x27;&amp;nbsp;&#x27; * tab_width)&quot;]}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;read_file&#x27;, &#x27;target_inputs&#x27;: [&#x27;file_path&#x27;], &#x27;target_returns&#x27;: [&#x27;yaml.load(f)&#x27;, &#x27;json.load(f)&#x27;]}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;write_file&#x27;, &#x27;target_inputs&#x27;: [&#x27;data&#x27;, &#x27;file_path&#x27;], &#x27;target_returns&#x27;: []}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;read_file&#x27;, &#x27;target_inputs&#x27;: [&#x27;file_path&#x27;], &#x27;target_returns&#x27;: [&#x27;yaml.load(f)&#x27;, &#x27;json.load(f)&#x27;]}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target_inputs&#x27;: [&#x27;directory&#x27;], &#x27;target_returns&#x27;: [&quot;text.replace(&#x27; &#x27;, &#x27;&amp;nbsp;&#x27;).replace(&#x27;\\t&#x27;, &#x27;&amp;nbsp;&#x27; * tab_width)&quot;]}]}</td></tr><tr><td>What are the structural relationships between the functions and classes defined and used in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>&quot;&quot;&quot;<br/>Requirements:<br/>[req01]&nbsp;The&nbsp;`read_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Read&nbsp;and&nbsp;return&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>[req02]&nbsp;The&nbsp;`write_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;dictionary&nbsp;and&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Write&nbsp;the&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;file&nbsp;in&nbsp;either&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;format.<br/>[req03]&nbsp;The&nbsp;`convert_json_to_html`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;each&nbsp;converted&nbsp;file&nbsp;with&nbsp;a&nbsp;.html&nbsp;extension.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Preserve&nbsp;spacing&nbsp;and&nbsp;tabs&nbsp;for&nbsp;the&nbsp;&#x27;input&#x27;&nbsp;field.<br/>[req04]&nbsp;The&nbsp;`combine_json_files`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;directory&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Merge&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Remove&nbsp;duplicates&nbsp;from&nbsp;the&nbsp;combined&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Write&nbsp;the&nbsp;combined&nbsp;data&nbsp;to&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;&#x27;instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Generate&nbsp;and&nbsp;save&nbsp;&#x27;qa_purpose.json&#x27;,&nbsp;&#x27;qa_instruct.json&#x27;,&nbsp;and&nbsp;&#x27;qa_cleaned_instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;Convert&nbsp;the&nbsp;merged&nbsp;JSON&nbsp;files&nbsp;to&nbsp;HTML&nbsp;format&nbsp;if&nbsp;the&nbsp;html&nbsp;flag&nbsp;is&nbsp;set&nbsp;to&nbsp;True.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.&nbsp;Return&nbsp;the&nbsp;&#x27;qa_list&#x27;&nbsp;and&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>[req05]&nbsp;The&nbsp;`create_code_graph`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Generate&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;file&nbsp;details.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;graphs&nbsp;as&nbsp;PNG&nbsp;images&nbsp;in&nbsp;the&nbsp;specified&nbsp;output&nbsp;directory.<br/>&quot;&quot;&quot;<br/>import&nbsp;sys<br/>import&nbsp;os<br/>import&nbsp;re<br/>import&nbsp;json<br/>import&nbsp;logging<br/>import&nbsp;yaml<br/>import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br/>import&nbsp;networkx&nbsp;as&nbsp;nx<br/>from&nbsp;html&nbsp;import&nbsp;escape<br/>from&nbsp;pathlib&nbsp;import&nbsp;Path<br/>from&nbsp;typing&nbsp;import&nbsp;Dict,&nbsp;List,&nbsp;Union<br/><br/><br/>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)<br/><br/><br/>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)<br/><br/><br/>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int&nbsp;=&nbsp;4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&quot;&nbsp;&quot;,&nbsp;&quot;&amp;nbsp;&quot;).replace(&quot;\t&quot;,&nbsp;&quot;&amp;nbsp;&quot;&nbsp;*&nbsp;tab_width)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;width:&nbsp;100%;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{border:&nbsp;1px&nbsp;solid&nbsp;black;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;left;&nbsp;white-space:&nbsp;pre-line;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;td:nth-child(2)&nbsp;{&nbsp;width:&nbsp;50%;&nbsp;overflow-wrap:&nbsp;anywhere;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;tr&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;\n&nbsp;to&nbsp;HTML&nbsp;line&nbsp;breaks<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;key&nbsp;==&nbsp;&quot;input&quot;:&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;td&gt;{value}&lt;/td&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;/tr&gt;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))<br/><br/><br/>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;purpose-specific&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Reset&nbsp;combined_data&nbsp;for&nbsp;the&nbsp;next&nbsp;iteration<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;remove&nbsp;duplicate&nbsp;&quot;input&quot;&nbsp;info&nbsp;in&nbsp;the&nbsp;instruct.json&nbsp;and&nbsp;instruct_purpose.json&nbsp;information&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;to&nbsp;make&nbsp;a&nbsp;cleaned_instruct.json&nbsp;cleaned_instruct_purpose_json<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;+&nbsp;file)&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;save&nbsp;html&nbsp;file&nbsp;for&nbsp;each&nbsp;json&nbsp;file&nbsp;in&nbsp;the&nbsp;output&nbsp;directory<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}<br/><br/><br/>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;graph_type&nbsp;in&nbsp;[&#x27;internal_code_graph&#x27;,&nbsp;&#x27;entire_code_graph&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;graphs<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node_name&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_node(node_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Add&nbsp;edges<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;=&nbsp;edge[&#x27;source&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_inputs&#x27;]&nbsp;=&nbsp;edge[&#x27;target_inputs&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_returns&#x27;]&nbsp;=&nbsp;edge[&#x27;target_returns&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**edge_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Save&nbsp;code&nbsp;graph&nbsp;as&nbsp;png<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size&nbsp;=&nbsp;8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[(edge[0],&nbsp;edge[1])]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()&nbsp;&nbsp;#&nbsp;Close&nbsp;the&nbsp;figure</td><td>{&#x27;nodes&#x27;: [&#x27;read_file&#x27;, &#x27;write_file&#x27;, &#x27;convert_json_to_html&#x27;, &#x27;preserve_spacing&#x27;, &#x27;combine_json_files&#x27;, &#x27;create_code_graph&#x27;, &#x27;file_path.open&#x27;, &#x27;json.load&#x27;, &#x27;yaml.load&#x27;, &#x27;json.dump&#x27;, &#x27;yaml.dump&#x27;, &#x27;Path&#x27;, &#x27;logging.info&#x27;, &quot;text.replace(&#x27; &#x27;, &#x27;&amp;nbsp;&#x27;).replace&quot;, &#x27;file.write&#x27;, &#x27;str&#x27;, &#x27;escape&#x27;, &#x27;logging.save&#x27;, &#x27;dataset[0].keys&#x27;, &#x27;json_file.with_suffix&#x27;, &#x27;Path(directory).rglob&#x27;, &#x27;text.replace&#x27;, &#x27;open&#x27;, &#x27;value.replace&#x27;, &#x27;item[keys[file_names.index(file)]].startswith&#x27;, &#x27;file_path.with_name&#x27;, &#x27;set&#x27;, &#x27;purpose_data.append&#x27;, &#x27;list&#x27;, &#x27;file_names.index&#x27;, &#x27;seen_inputs.add&#x27;, &#x27;combined_data.extend&#x27;, &#x27;{i[keys[file_names.index(file)]]: i for i in combined_data}.values&#x27;, &#x27;file_path.exists&#x27;, &#x27;combined_data.copy&#x27;, &#x27;nx.DiGraph&#x27;, &#x27;G.add_node&#x27;, &#x27;plt.figure&#x27;, &#x27;nx.draw_networkx_edge_labels&#x27;, &#x27;label.append&#x27;, &#x27;plt.savefig&#x27;, &#x27;G.edges&#x27;, &quot;&#x27;\\n&#x27;.join&quot;, &quot;&#x27;, &#x27;.join&quot;, &#x27;nx.draw&#x27;, &#x27;G.add_edge&#x27;, &#x27;nx.spring_layout&#x27;, &#x27;plt.close&#x27;], &#x27;edges&#x27;: [{&#x27;source&#x27;: &#x27;read_file&#x27;, &#x27;target&#x27;: &#x27;file_path.open&#x27;}, {&#x27;source&#x27;: &#x27;read_file&#x27;, &#x27;target&#x27;: &#x27;json.load&#x27;}, {&#x27;source&#x27;: &#x27;read_file&#x27;, &#x27;target&#x27;: &#x27;yaml.load&#x27;}, {&#x27;source&#x27;: &#x27;write_file&#x27;, &#x27;target&#x27;: &#x27;file_path.open&#x27;}, {&#x27;source&#x27;: &#x27;write_file&#x27;, &#x27;target&#x27;: &#x27;json.dump&#x27;}, {&#x27;source&#x27;: &#x27;write_file&#x27;, &#x27;target&#x27;: &#x27;yaml.dump&#x27;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;Path&#x27;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;logging.info&#x27;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &quot;text.replace(&#x27; &#x27;, &#x27;&amp;nbsp;&#x27;).replace&quot;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;preserve_spacing&#x27;, &#x27;target_inputs&#x27;: [&#x27;text&#x27;, &#x27;tab_width&#x27;], &#x27;target_returns&#x27;: [&quot;text.replace(&#x27; &#x27;, &#x27;&amp;nbsp;&#x27;).replace(&#x27;\\t&#x27;, &#x27;&amp;nbsp;&#x27; * tab_width)&quot;]}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;file.write&#x27;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;str&#x27;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;escape&#x27;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;logging.save&#x27;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;dataset[0].keys&#x27;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;json_file.with_suffix&#x27;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;read_file&#x27;, &#x27;target_inputs&#x27;: [&#x27;file_path&#x27;], &#x27;target_returns&#x27;: [&#x27;yaml.load(f)&#x27;, &#x27;json.load(f)&#x27;]}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;Path(directory).rglob&#x27;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;text.replace&#x27;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;open&#x27;}, {&#x27;source&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target&#x27;: &#x27;value.replace&#x27;}, {&#x27;source&#x27;: &#x27;preserve_spacing&#x27;, &#x27;target&#x27;: &quot;text.replace(&#x27; &#x27;, &#x27;&amp;nbsp;&#x27;).replace&quot;}, {&#x27;source&#x27;: &#x27;preserve_spacing&#x27;, &#x27;target&#x27;: &#x27;text.replace&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;Path&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;item[keys[file_names.index(file)]].startswith&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;write_file&#x27;, &#x27;target_inputs&#x27;: [&#x27;data&#x27;, &#x27;file_path&#x27;], &#x27;target_returns&#x27;: []}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;file_path.with_name&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;set&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;purpose_data.append&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;list&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;file_names.index&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;seen_inputs.add&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;combined_data.extend&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;{i[keys[file_names.index(file)]]: i for i in combined_data}.values&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;read_file&#x27;, &#x27;target_inputs&#x27;: [&#x27;file_path&#x27;], &#x27;target_returns&#x27;: [&#x27;yaml.load(f)&#x27;, &#x27;json.load(f)&#x27;]}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;file_path.exists&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;Path(directory).rglob&#x27;}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;convert_json_to_html&#x27;, &#x27;target_inputs&#x27;: [&#x27;directory&#x27;], &#x27;target_returns&#x27;: [&quot;text.replace(&#x27; &#x27;, &#x27;&amp;nbsp;&#x27;).replace(&#x27;\\t&#x27;, &#x27;&amp;nbsp;&#x27; * tab_width)&quot;]}, {&#x27;source&#x27;: &#x27;combine_json_files&#x27;, &#x27;target&#x27;: &#x27;combined_data.copy&#x27;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &#x27;nx.DiGraph&#x27;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &#x27;G.add_node&#x27;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &#x27;plt.figure&#x27;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &#x27;nx.draw_networkx_edge_labels&#x27;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &#x27;label.append&#x27;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &#x27;plt.savefig&#x27;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &#x27;G.edges&#x27;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &quot;&#x27;\\n&#x27;.join&quot;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &quot;&#x27;, &#x27;.join&quot;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &#x27;nx.draw&#x27;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &#x27;G.add_edge&#x27;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &#x27;nx.spring_layout&#x27;}, {&#x27;source&#x27;: &#x27;create_code_graph&#x27;, &#x27;target&#x27;: &#x27;plt.close&#x27;}]}</td></tr><tr><td>What functions are defined in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>&quot;&quot;&quot;<br/>Requirements:<br/>[req01]&nbsp;The&nbsp;`read_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Read&nbsp;and&nbsp;return&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>[req02]&nbsp;The&nbsp;`write_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;dictionary&nbsp;and&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Write&nbsp;the&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;file&nbsp;in&nbsp;either&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;format.<br/>[req03]&nbsp;The&nbsp;`convert_json_to_html`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;each&nbsp;converted&nbsp;file&nbsp;with&nbsp;a&nbsp;.html&nbsp;extension.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Preserve&nbsp;spacing&nbsp;and&nbsp;tabs&nbsp;for&nbsp;the&nbsp;&#x27;input&#x27;&nbsp;field.<br/>[req04]&nbsp;The&nbsp;`combine_json_files`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;directory&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Merge&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Remove&nbsp;duplicates&nbsp;from&nbsp;the&nbsp;combined&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Write&nbsp;the&nbsp;combined&nbsp;data&nbsp;to&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;&#x27;instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Generate&nbsp;and&nbsp;save&nbsp;&#x27;qa_purpose.json&#x27;,&nbsp;&#x27;qa_instruct.json&#x27;,&nbsp;and&nbsp;&#x27;qa_cleaned_instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;Convert&nbsp;the&nbsp;merged&nbsp;JSON&nbsp;files&nbsp;to&nbsp;HTML&nbsp;format&nbsp;if&nbsp;the&nbsp;html&nbsp;flag&nbsp;is&nbsp;set&nbsp;to&nbsp;True.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.&nbsp;Return&nbsp;the&nbsp;&#x27;qa_list&#x27;&nbsp;and&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>[req05]&nbsp;The&nbsp;`create_code_graph`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Generate&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;file&nbsp;details.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;graphs&nbsp;as&nbsp;PNG&nbsp;images&nbsp;in&nbsp;the&nbsp;specified&nbsp;output&nbsp;directory.<br/>&quot;&quot;&quot;<br/>import&nbsp;sys<br/>import&nbsp;os<br/>import&nbsp;re<br/>import&nbsp;json<br/>import&nbsp;logging<br/>import&nbsp;yaml<br/>import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br/>import&nbsp;networkx&nbsp;as&nbsp;nx<br/>from&nbsp;html&nbsp;import&nbsp;escape<br/>from&nbsp;pathlib&nbsp;import&nbsp;Path<br/>from&nbsp;typing&nbsp;import&nbsp;Dict,&nbsp;List,&nbsp;Union<br/><br/><br/>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)<br/><br/><br/>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)<br/><br/><br/>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int&nbsp;=&nbsp;4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&quot;&nbsp;&quot;,&nbsp;&quot;&amp;nbsp;&quot;).replace(&quot;\t&quot;,&nbsp;&quot;&amp;nbsp;&quot;&nbsp;*&nbsp;tab_width)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;width:&nbsp;100%;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{border:&nbsp;1px&nbsp;solid&nbsp;black;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;left;&nbsp;white-space:&nbsp;pre-line;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;td:nth-child(2)&nbsp;{&nbsp;width:&nbsp;50%;&nbsp;overflow-wrap:&nbsp;anywhere;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;tr&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;\n&nbsp;to&nbsp;HTML&nbsp;line&nbsp;breaks<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;key&nbsp;==&nbsp;&quot;input&quot;:&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;td&gt;{value}&lt;/td&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;/tr&gt;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))<br/><br/><br/>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;purpose-specific&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Reset&nbsp;combined_data&nbsp;for&nbsp;the&nbsp;next&nbsp;iteration<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;remove&nbsp;duplicate&nbsp;&quot;input&quot;&nbsp;info&nbsp;in&nbsp;the&nbsp;instruct.json&nbsp;and&nbsp;instruct_purpose.json&nbsp;information&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;to&nbsp;make&nbsp;a&nbsp;cleaned_instruct.json&nbsp;cleaned_instruct_purpose_json<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;+&nbsp;file)&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;save&nbsp;html&nbsp;file&nbsp;for&nbsp;each&nbsp;json&nbsp;file&nbsp;in&nbsp;the&nbsp;output&nbsp;directory<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}<br/><br/><br/>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;graph_type&nbsp;in&nbsp;[&#x27;internal_code_graph&#x27;,&nbsp;&#x27;entire_code_graph&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;graphs<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node_name&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_node(node_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Add&nbsp;edges<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;=&nbsp;edge[&#x27;source&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_inputs&#x27;]&nbsp;=&nbsp;edge[&#x27;target_inputs&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_returns&#x27;]&nbsp;=&nbsp;edge[&#x27;target_returns&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**edge_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Save&nbsp;code&nbsp;graph&nbsp;as&nbsp;png<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size&nbsp;=&nbsp;8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[(edge[0],&nbsp;edge[1])]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()&nbsp;&nbsp;#&nbsp;Close&nbsp;the&nbsp;figure</td><td>preserve_spacing, write_file, create_code_graph, read_file, convert_json_to_html, combine_json_files</td></tr><tr><td>What is the control flow of the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>&quot;&quot;&quot;<br/>Requirements:<br/>[req01]&nbsp;The&nbsp;`read_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Read&nbsp;and&nbsp;return&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>[req02]&nbsp;The&nbsp;`write_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;dictionary&nbsp;and&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Write&nbsp;the&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;file&nbsp;in&nbsp;either&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;format.<br/>[req03]&nbsp;The&nbsp;`convert_json_to_html`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;each&nbsp;converted&nbsp;file&nbsp;with&nbsp;a&nbsp;.html&nbsp;extension.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Preserve&nbsp;spacing&nbsp;and&nbsp;tabs&nbsp;for&nbsp;the&nbsp;&#x27;input&#x27;&nbsp;field.<br/>[req04]&nbsp;The&nbsp;`combine_json_files`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;directory&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Merge&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Remove&nbsp;duplicates&nbsp;from&nbsp;the&nbsp;combined&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Write&nbsp;the&nbsp;combined&nbsp;data&nbsp;to&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;&#x27;instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Generate&nbsp;and&nbsp;save&nbsp;&#x27;qa_purpose.json&#x27;,&nbsp;&#x27;qa_instruct.json&#x27;,&nbsp;and&nbsp;&#x27;qa_cleaned_instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;Convert&nbsp;the&nbsp;merged&nbsp;JSON&nbsp;files&nbsp;to&nbsp;HTML&nbsp;format&nbsp;if&nbsp;the&nbsp;html&nbsp;flag&nbsp;is&nbsp;set&nbsp;to&nbsp;True.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.&nbsp;Return&nbsp;the&nbsp;&#x27;qa_list&#x27;&nbsp;and&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>[req05]&nbsp;The&nbsp;`create_code_graph`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Generate&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;file&nbsp;details.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;graphs&nbsp;as&nbsp;PNG&nbsp;images&nbsp;in&nbsp;the&nbsp;specified&nbsp;output&nbsp;directory.<br/>&quot;&quot;&quot;<br/>import&nbsp;sys<br/>import&nbsp;os<br/>import&nbsp;re<br/>import&nbsp;json<br/>import&nbsp;logging<br/>import&nbsp;yaml<br/>import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br/>import&nbsp;networkx&nbsp;as&nbsp;nx<br/>from&nbsp;html&nbsp;import&nbsp;escape<br/>from&nbsp;pathlib&nbsp;import&nbsp;Path<br/>from&nbsp;typing&nbsp;import&nbsp;Dict,&nbsp;List,&nbsp;Union<br/><br/><br/>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)<br/><br/><br/>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)<br/><br/><br/>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int&nbsp;=&nbsp;4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&quot;&nbsp;&quot;,&nbsp;&quot;&amp;nbsp;&quot;).replace(&quot;\t&quot;,&nbsp;&quot;&amp;nbsp;&quot;&nbsp;*&nbsp;tab_width)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;width:&nbsp;100%;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{border:&nbsp;1px&nbsp;solid&nbsp;black;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;left;&nbsp;white-space:&nbsp;pre-line;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;td:nth-child(2)&nbsp;{&nbsp;width:&nbsp;50%;&nbsp;overflow-wrap:&nbsp;anywhere;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;tr&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;\n&nbsp;to&nbsp;HTML&nbsp;line&nbsp;breaks<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;key&nbsp;==&nbsp;&quot;input&quot;:&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;td&gt;{value}&lt;/td&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;/tr&gt;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))<br/><br/><br/>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;purpose-specific&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Reset&nbsp;combined_data&nbsp;for&nbsp;the&nbsp;next&nbsp;iteration<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;remove&nbsp;duplicate&nbsp;&quot;input&quot;&nbsp;info&nbsp;in&nbsp;the&nbsp;instruct.json&nbsp;and&nbsp;instruct_purpose.json&nbsp;information&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;to&nbsp;make&nbsp;a&nbsp;cleaned_instruct.json&nbsp;cleaned_instruct_purpose_json<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;+&nbsp;file)&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;save&nbsp;html&nbsp;file&nbsp;for&nbsp;each&nbsp;json&nbsp;file&nbsp;in&nbsp;the&nbsp;output&nbsp;directory<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}<br/><br/><br/>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;graph_type&nbsp;in&nbsp;[&#x27;internal_code_graph&#x27;,&nbsp;&#x27;entire_code_graph&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;graphs<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node_name&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_node(node_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Add&nbsp;edges<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;=&nbsp;edge[&#x27;source&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_inputs&#x27;]&nbsp;=&nbsp;edge[&#x27;target_inputs&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_returns&#x27;]&nbsp;=&nbsp;edge[&#x27;target_returns&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**edge_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Save&nbsp;code&nbsp;graph&nbsp;as&nbsp;png<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size&nbsp;=&nbsp;8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[(edge[0],&nbsp;edge[1])]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()&nbsp;&nbsp;#&nbsp;Close&nbsp;the&nbsp;figure</td><td>module -&gt; def read_file -&gt; with -&gt; if -&gt; if -&gt; def write_file -&gt; with -&gt; if -&gt; if -&gt; def convert_json_to_html -&gt; def preserve_spacing -&gt; for -&gt; if -&gt; for -&gt; for -&gt; for -&gt; if -&gt; try -&gt; with -&gt; except -&gt; def combine_json_files -&gt; for -&gt; if -&gt; for -&gt; if -&gt; if -&gt; for -&gt; if -&gt; if -&gt; for -&gt; if -&gt; if -&gt; for -&gt; if -&gt; if -&gt; def create_code_graph -&gt; for -&gt; for -&gt; for -&gt; if -&gt; if -&gt; if -&gt; for -&gt; if -&gt; if</td></tr><tr><td>What are the inputs to the function: &#x27;read_file&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)</td><td>file_path</td></tr><tr><td>What are the inputs to the function: &#x27;write_file&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)</td><td>data, file_path</td></tr><tr><td>What are the inputs to the function: &#x27;convert_json_to_html&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;width:&nbsp;100%;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{border:&nbsp;1px&nbsp;solid&nbsp;black;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;left;&nbsp;white-space:&nbsp;pre-line;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;td:nth-child(2)&nbsp;{&nbsp;width:&nbsp;50%;&nbsp;overflow-wrap:&nbsp;anywhere;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;th&gt;{key}&lt;/th&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;key&nbsp;==&nbsp;&#x27;input&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;td&gt;{value}&lt;/td&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;/tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))</td><td>directory</td></tr><tr><td>What are the inputs to the function: &#x27;preserve_spacing&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)</td><td>text, tab_width</td></tr><tr><td>What are the inputs to the function: &#x27;combine_json_files&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;&nbsp;+&nbsp;file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}</td><td>directory, html</td></tr><tr><td>What are the inputs to the function: &#x27;create_code_graph&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;graph_type&nbsp;in&nbsp;[&#x27;internal_code_graph&#x27;,&nbsp;&#x27;entire_code_graph&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node_name&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_node(node_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;=&nbsp;edge[&#x27;source&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_inputs&#x27;]&nbsp;=&nbsp;edge[&#x27;target_inputs&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_returns&#x27;]&nbsp;=&nbsp;edge[&#x27;target_returns&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**edge_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size=8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[edge[0],&nbsp;edge[1]]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</td><td>output_subdir, base_name, file_details</td></tr><tr><td>What is the docstring of the function: &#x27;read_file&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)</td><td>Reads a JSON or YAML file and returns its contents as a dictionary. Args: file_path Path: The path to the file. Returns: The contents of the file as a dictionary.</td></tr><tr><td>What is the docstring of the function: &#x27;write_file&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)</td><td>Writes a dictionary to a JSON or YAML file. Args: data Dict: The data to write to the file. file_path Path: The path to the file.</td></tr><tr><td>What is the docstring of the function: &#x27;preserve_spacing&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)</td><td>Preserve spaces and tabs in the provided text.</td></tr><tr><td>What is the docstring of the function: &#x27;combine_json_files&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;&nbsp;+&nbsp;file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}</td><td>Combine all JSON files in the output directory into qa.json and instruct.json, and then remove duplicates. Args: directory str: The directory where the output files are located.</td></tr><tr><td>What is the docstring of the function: &#x27;create_code_graph&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;graph_type&nbsp;in&nbsp;[&#x27;internal_code_graph&#x27;,&nbsp;&#x27;entire_code_graph&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node_name&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_node(node_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;=&nbsp;edge[&#x27;source&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_inputs&#x27;]&nbsp;=&nbsp;edge[&#x27;target_inputs&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_returns&#x27;]&nbsp;=&nbsp;edge[&#x27;target_returns&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**edge_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size=8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[edge[0],&nbsp;edge[1]]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</td><td>Generate graphs from the file_details and save them as PNG images. Args: file_details dict: The details extracted from the Python file. base_name str: The base name of the output files. output_subdir Path: The subdirectory where the output files will be saved.</td></tr><tr><td>What calls are made in the function: &#x27;read_file&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)</td><td>file_path.open, json.load, yaml.load</td></tr><tr><td>What calls are made in the function: &#x27;write_file&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)</td><td>file_path.open, json.dump, yaml.dump</td></tr><tr><td>What calls are made in the function: &#x27;convert_json_to_html&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;width:&nbsp;100%;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{border:&nbsp;1px&nbsp;solid&nbsp;black;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;left;&nbsp;white-space:&nbsp;pre-line;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;td:nth-child(2)&nbsp;{&nbsp;width:&nbsp;50%;&nbsp;overflow-wrap:&nbsp;anywhere;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;th&gt;{key}&lt;/th&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;key&nbsp;==&nbsp;&#x27;input&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;td&gt;{value}&lt;/td&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;/tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))</td><td>Path, logging.info, preserve_spacing, file.write, str, logging.save, dataset0.keys, text.replace, text.replace , Pathdirectory.rglob, json_file.with_suffix, read_file, nbsp.replace, escape, open, value.replace</td></tr><tr><td>What calls are made in the function: &#x27;preserve_spacing&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)</td><td>text.replace , nbsp.replace, text.replace</td></tr><tr><td>What calls are made in the function: &#x27;combine_json_files&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;&nbsp;+&nbsp;file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}</td><td>Path, itemkeysfile_names.indexfile.startswith, write_file, file_path.with_name, set, combined_data.copy, purpose_data.append, Pathdirectory.rglob, file_names.index, seen_inputs.add, combined_data.extend, list, file_path.exists, convert_json_to_html, ikeysfile_names.indexfile: i for i in combined_data.values, read_file</td></tr><tr><td>What calls are made in the function: &#x27;create_code_graph&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;graph_type&nbsp;in&nbsp;[&#x27;internal_code_graph&#x27;,&nbsp;&#x27;entire_code_graph&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node_name&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_node(node_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;=&nbsp;edge[&#x27;source&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_inputs&#x27;]&nbsp;=&nbsp;edge[&#x27;target_inputs&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_returns&#x27;]&nbsp;=&nbsp;edge[&#x27;target_returns&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**edge_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size=8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[edge[0],&nbsp;edge[1]]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</td><td>nx.DiGraph, G.add_node, , plt.figure, nx.draw_networkx_edge_labels, n.join, label.append, nx.draw, plt.savefig, .join, G.edges, G.add_edge, nx.spring_layout, plt.close</td></tr><tr><td>What variables are defined in the function: &#x27;read_file&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)</td><td>file_type</td></tr><tr><td>What variables are defined in the function: &#x27;write_file&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)</td><td>file_type</td></tr><tr><td>What variables are defined in the function: &#x27;convert_json_to_html&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;width:&nbsp;100%;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{border:&nbsp;1px&nbsp;solid&nbsp;black;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;left;&nbsp;white-space:&nbsp;pre-line;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;td:nth-child(2)&nbsp;{&nbsp;width:&nbsp;50%;&nbsp;overflow-wrap:&nbsp;anywhere;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;th&gt;{key}&lt;/th&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;key&nbsp;==&nbsp;&#x27;input&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;td&gt;{value}&lt;/td&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;/tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))</td><td>dataset, html_content, html_file_path, html_file, value</td></tr><tr><td>What variables are defined in the function: &#x27;combine_json_files&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;&nbsp;+&nbsp;file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}</td><td>dataset, instruct_data, qa_data, file_names, file_path, cleaned_instruct_file_path, seen_inputs, purpose_file_path, combined_data, keys, purpose_data</td></tr><tr><td>What variables are defined in the function: &#x27;create_code_graph&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;graph_type&nbsp;in&nbsp;[&#x27;internal_code_graph&#x27;,&nbsp;&#x27;entire_code_graph&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node_name&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_node(node_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;=&nbsp;edge[&#x27;source&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_inputs&#x27;]&nbsp;=&nbsp;edge[&#x27;target_inputs&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_returns&#x27;]&nbsp;=&nbsp;edge[&#x27;target_returns&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**edge_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size=8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[edge[0],&nbsp;edge[1]]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</td><td>label, source, G, edge_data, pos, output_file, target, edge_labels</td></tr><tr><td>What are the returned items from the function: &#x27;read_file&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)</td><td>json.loadf, yaml.loadf</td></tr><tr><td>What are the returned items from the function: &#x27;convert_json_to_html&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;width:&nbsp;100%;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{border:&nbsp;1px&nbsp;solid&nbsp;black;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;left;&nbsp;white-space:&nbsp;pre-line;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;td:nth-child(2)&nbsp;{&nbsp;width:&nbsp;50%;&nbsp;overflow-wrap:&nbsp;anywhere;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;th&gt;{key}&lt;/th&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;key&nbsp;==&nbsp;&#x27;input&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;td&gt;{value}&lt;/td&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;/tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))</td><td>text.replace , nbsp.replacet, nbsp  tab_width</td></tr><tr><td>What are the returned items from the function: &#x27;preserve_spacing&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)</td><td>text.replace , nbsp.replacet, nbsp  tab_width</td></tr><tr><td>What are the returned items from the function: &#x27;combine_json_files&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;&nbsp;+&nbsp;file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}</td><td>instruct_list: instruct_data, qa_list: qa_data</td></tr><tr><td>What is the purpose and processing summary of the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>&quot;&quot;&quot;<br/>Requirements:<br/>[req01]&nbsp;The&nbsp;`read_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Read&nbsp;and&nbsp;return&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>[req02]&nbsp;The&nbsp;`write_file`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;dictionary&nbsp;and&nbsp;a&nbsp;file&nbsp;path&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Write&nbsp;the&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;file&nbsp;in&nbsp;either&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;format.<br/>[req03]&nbsp;The&nbsp;`convert_json_to_html`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Convert&nbsp;JSON&nbsp;files&nbsp;within&nbsp;a&nbsp;given&nbsp;directory&nbsp;to&nbsp;HTML&nbsp;format.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Save&nbsp;each&nbsp;converted&nbsp;file&nbsp;with&nbsp;a&nbsp;.html&nbsp;extension.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Preserve&nbsp;spacing&nbsp;and&nbsp;tabs&nbsp;for&nbsp;the&nbsp;&#x27;input&#x27;&nbsp;field.<br/>[req04]&nbsp;The&nbsp;`combine_json_files`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;a&nbsp;directory&nbsp;path&nbsp;as&nbsp;an&nbsp;argument.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Merge&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Remove&nbsp;duplicates&nbsp;from&nbsp;the&nbsp;combined&nbsp;JSON&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.&nbsp;Write&nbsp;the&nbsp;combined&nbsp;data&nbsp;to&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;&#x27;instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.&nbsp;Generate&nbsp;and&nbsp;save&nbsp;&#x27;qa_purpose.json&#x27;,&nbsp;&#x27;qa_instruct.json&#x27;,&nbsp;and&nbsp;&#x27;qa_cleaned_instruct.json&#x27;&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.&nbsp;Convert&nbsp;the&nbsp;merged&nbsp;JSON&nbsp;files&nbsp;to&nbsp;HTML&nbsp;format&nbsp;if&nbsp;the&nbsp;html&nbsp;flag&nbsp;is&nbsp;set&nbsp;to&nbsp;True.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.&nbsp;Return&nbsp;the&nbsp;&#x27;qa_list&#x27;&nbsp;and&nbsp;&#x27;instruct_list&#x27;&nbsp;datasets.<br/>[req05]&nbsp;The&nbsp;`create_code_graph`&nbsp;function&nbsp;shall:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.&nbsp;Accept&nbsp;details&nbsp;of&nbsp;a&nbsp;Python&nbsp;file,&nbsp;a&nbsp;base&nbsp;name,&nbsp;and&nbsp;an&nbsp;output&nbsp;directory&nbsp;as&nbsp;arguments.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.&nbsp;Generate&nbsp;code&nbsp;graphs&nbsp;based&nbsp;on&nbsp;the&nbsp;provided&nbsp;file&nbsp;details.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.&nbsp;Save&nbsp;the&nbsp;graphs&nbsp;as&nbsp;PNG&nbsp;images&nbsp;in&nbsp;the&nbsp;specified&nbsp;output&nbsp;directory.<br/>&quot;&quot;&quot;<br/>import&nbsp;sys<br/>import&nbsp;os<br/>import&nbsp;re<br/>import&nbsp;json<br/>import&nbsp;logging<br/>import&nbsp;yaml<br/>import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br/>import&nbsp;networkx&nbsp;as&nbsp;nx<br/>from&nbsp;html&nbsp;import&nbsp;escape<br/>from&nbsp;pathlib&nbsp;import&nbsp;Path<br/>from&nbsp;typing&nbsp;import&nbsp;Dict,&nbsp;List,&nbsp;Union<br/><br/><br/>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)<br/><br/><br/>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)<br/><br/><br/>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int&nbsp;=&nbsp;4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&quot;&nbsp;&quot;,&nbsp;&quot;&amp;nbsp;&quot;).replace(&quot;\t&quot;,&nbsp;&quot;&amp;nbsp;&quot;&nbsp;*&nbsp;tab_width)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;width:&nbsp;100%;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{border:&nbsp;1px&nbsp;solid&nbsp;black;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;left;&nbsp;white-space:&nbsp;pre-line;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;td:nth-child(2)&nbsp;{&nbsp;width:&nbsp;50%;&nbsp;overflow-wrap:&nbsp;anywhere;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;th&gt;{key}&lt;/th&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;tr&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;\n&nbsp;to&nbsp;HTML&nbsp;line&nbsp;breaks<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;key&nbsp;==&nbsp;&quot;input&quot;:&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&quot;&lt;td&gt;{value}&lt;/td&gt;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&lt;/tr&gt;&quot;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))<br/><br/><br/>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;purpose-specific&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Reset&nbsp;combined_data&nbsp;for&nbsp;the&nbsp;next&nbsp;iteration<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;remove&nbsp;duplicate&nbsp;&quot;input&quot;&nbsp;info&nbsp;in&nbsp;the&nbsp;instruct.json&nbsp;and&nbsp;instruct_purpose.json&nbsp;information&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;to&nbsp;make&nbsp;a&nbsp;cleaned_instruct.json&nbsp;cleaned_instruct_purpose_json<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;+&nbsp;file)&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;save&nbsp;html&nbsp;file&nbsp;for&nbsp;each&nbsp;json&nbsp;file&nbsp;in&nbsp;the&nbsp;output&nbsp;directory<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}<br/><br/><br/>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;graph_type&nbsp;in&nbsp;[&#x27;internal_code_graph&#x27;,&nbsp;&#x27;entire_code_graph&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;graphs<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node_name&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_node(node_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Add&nbsp;edges<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;=&nbsp;edge[&#x27;source&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_inputs&#x27;]&nbsp;=&nbsp;edge[&#x27;target_inputs&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_returns&#x27;]&nbsp;=&nbsp;edge[&#x27;target_returns&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**edge_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Save&nbsp;code&nbsp;graph&nbsp;as&nbsp;png<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size&nbsp;=&nbsp;8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[(edge[0],&nbsp;edge[1])]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()&nbsp;&nbsp;#&nbsp;Close&nbsp;the&nbsp;figure</td><td>The Python code provided, `py2dataset.save_py2dataset_output.py`, serves as a back-end process for creating dataset files in JSON format to train various machine learning models such as question answering systems or language translation systems. Here&#x27;s what the purpose and processing summary of this file would look like:<br/><br/>**Purpose:** This Python script is designed to convert large python scripts into a dataset that can be used by AI/ML algorithms, specifically for training purposes. The main purpose is to allow models to read, analyze, manipulate and understand complex code in an objective way. <br/><br/>**Processing Summary:** This file contains two functions (`read_file` and `write_file`) which are responsible for reading a python script into memory (through the use of `open()`), as well as writing that data back out to disk as JSON or YAML format files respectively. The script then enters an &#x27;if&#x27; condition, checking if it&#x27;s dealing with either JSON or YAML file formats and creates appropriate dictionaries based on those file types.<br/><br/>The next group contains three more functions (`convert_json_to_html`, `combine_json_files` and `create_code_graph`). The first function is a helper function that converts all the json files in a given directory into an HTML format, while the second one combines multiple JSON files together, removes duplicates from those combined files, generates new datasets based on these operations, creates purpose-specific dataset files, cleans up &#x27;input&#x27; information and finally, uses `create_code_graph` to generate network graphs of code.<br/><br/>The graph generated by `create_code_graph`, if present in the file, is a representation of various internal and entire code structures as an image that can be used for visualizing these complex relationships within the python script.</td></tr><tr><td>What is the purpose and processing summary of the function: &#x27;read_file&#x27; defined in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)</td><td>The purpose of the function `read_file(file_path: Path) -&gt; Dict` is to read a JSON or YAML file and return its contents as a dictionary based on the provided file path parameter. This processing summary includes several key points:<br/><br/>1. The function is defined in &#x27;py2dataset.save_py2dataset_output.py&#x27;, which suggests that this code was part of an effort by AI language models to train themselves about Python programming, including functions like this one.<br/><br/>2. The function takes a Path object as input and returns a Dict. This indicates that the function will generally perform some operation involving paths and dictionaries.<br/><br/>3. Inside the function&#x27;s docstring, there is a brief explanation of what the function does (&quot;Reads a JSON or YAML file and returns its contents as a dictionary.&quot;), which can give insight into how the function might be used in practice. The parameters and return types are also included to provide clarity about what type of inputs it expects and what type of output it generates, respectively.<br/><br/>4. The &#x27;with&#x27; keyword is used within the function body for file handling. This suggests that the function may have some operations involving opening a file, reading from it, or closing it.<br/><br/>5. If the file_path&#x27;s suffix (i.e., extension) is &#x27;.json&#x27;, then the function assumes a JSON file and tries to load its contents into a Python dictionary using `json.load()`. Similarly, if the file_path&#x27;s suffix is &#x27;.yaml&#x27;, then the function assumes a YAML file and tries to load its contents into a Python dictionary using `yaml.load()`.<br/><br/>All these factors together suggest that &#x27;read_file&#x27; might be used in various parts of Python code for reading JSON or YAML files, either as dictionaries for further processing or converting their content into another data structure (like pandas DataFrames).</td></tr><tr><td>What is the purpose and processing summary of the function: &#x27;write_file&#x27; defined in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)</td><td>The &#x27;write_file&#x27; function in `py2dataset/save_py2dataset_output.py` serves as a crucial part of our data preprocessing script. It is designed to write dictionaries (data) into JSON or YAML files based on the file extension provided. The main purpose behind writing these outputs is that it allows us to easily store and retrieve the processed data for later use in other parts of the project.<br/><br/>Here&#x27;s a summary of how this function works:<br/><br/>- It takes two parameters, &#x27;data&#x27; (a dictionary) and &#x27;file_path&#x27; (the path where you want your file to be saved).<br/>- The function then determines what kind of extension is provided by the &#x27;file_path&#x27;. If it&#x27;s JSON (&#x27;json&#x27;), it will dump this data into a json formatted string. Similarly, if YAML (&#x27;yaml&#x27;) is provided, it will convert these dictionary data into a yaml formatted string and write to that file.<br/>- The function uses a context manager `with file_path.open(&#x27;w&#x27;) as f:` which opens the specified &#x27;file_path&#x27; in write mode and assigns the resultant file object to variable &#x27;f&#x27;. This ensures any changes made to the dictionary data will be written back to this file once we complete our script.<br/>- In case of YAML, there is a line `yaml.SafeDumper.ignore_aliases = lambda *args: True`. This piece of code ignores aliases when dumping objects with YAML, as it could lead to issues in certain situations where the same object is referenced multiple times within an object graph. We set this function to ensure safe YAML file creation and processing.<br/>- The &#x27;data&#x27; parameter is a dictionary that contains all the necessary data related to each language we are preprocessing from GitHub for our dataset. <br/>- This function will be used in various other parts of our `py2dataset/save_py2dataset_output.py` script, where it&#x27;s important to store and retrieve preprocessed output.</td></tr><tr><td>What is the purpose and processing summary of the function: &#x27;convert_json_to_html&#x27; defined in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;width:&nbsp;100%;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{border:&nbsp;1px&nbsp;solid&nbsp;black;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;left;&nbsp;white-space:&nbsp;pre-line;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;td:nth-child(2)&nbsp;{&nbsp;width:&nbsp;50%;&nbsp;overflow-wrap:&nbsp;anywhere;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;th&gt;{key}&lt;/th&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;key&nbsp;==&nbsp;&#x27;input&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;td&gt;{value}&lt;/td&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;/tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))</td><td>The &#x27;convert_json_to_html&#x27; function is a helper method within another script, specifically located at &#x27;py2dataset.save_py2dataset_output.py&#x27;, which serves to convert JSON files into HTML for easy visualization purposes. <br/><br/>The purpose of this function is twofold. Firstly, it creates an HTML table structure that displays the content from each individual JSON file in a structured manner, and secondly, it preserves spaces and tabs within text fields, as these can often be crucial when dealing with raw data or code output.<br/><br/>The processing summary of this function largely aligns with its purpose - creating an HTML table structure for the provided JSON files while preserving spacing and tabs. The function iterates over each file in a specified directory (the &#x27;directory&#x27; parameter), reads each file&#x27;s content, creates a corresponding HTML table based on that data, and writes out the resulting HTML to a new file within the same directory. <br/><br/>The main logic of the function involves reading JSON files from a given directory using Python&#x27;s built-in Path library, creating an HTML structure for those files&#x27; contents, preserving any whitespace characters (such as spaces or tabs), writing each resultant HTML page to a new file in the specified directory, and then moving on to the next file.<br/><br/>The function is designed to handle JSON data where some fields contain multi-line strings of code/text. It uses Python&#x27;s built-in &#x27;re&#x27; module for replacing newline characters with HTML breaks (`&lt;br/&gt;`), as well as the `escape()` method from the &#x27;cgi&#x27; library for escaping any unsafe characters in those text fields.<br/><br/>In summary, this function is used to transform data into a format that can be more easily visualized and understood by humans, particularly when it comes to multi-line strings of code or text. It&#x27;s important to note however, that the actual transformation done by the function may not always accurately represent what was present in the original JSON file due to factors like variable naming conventions, formatting changes between languages/platforms, etc.</td></tr><tr><td>What is the purpose and processing summary of the function: &#x27;preserve_spacing&#x27; defined in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)</td><td>The given python function, `&#x27;preserve_spacing(text: str, tab_width: int=4) -&gt; str:`, is a utility function that preserves spaces and tabs within a provided text string. The purpose of this function is to maintain the original spacing when displaying code in HTML or other markup languages where such characters can be difficult to display properly due to their size or potential ambiguity for users viewing the document in raw form.<br/><br/>When this function is called, it uses Python&#x27;s built-in `&#x27;replace()&#x27;` method to replace each space (&#x27; &#x27;) character with &#x27;&amp;nbsp;&#x27;, and each tab (&#x27;\t&#x27;) character is replaced by a string of &#x27;tab_width&#x27; number of &#x27;&amp;nbsp;&#x27; characters. The default value for `tab_width` is set to 4 if not provided when calling the function.<br/><br/>The processing summary includes: <br/>1) Replacing all spaces with &#x27;&amp;nbsp;&#x27;. This is done using Python&#x27;s built-in `&#x27;replace()&#x27;` method, which replaces a specified sequence of characters in a string (`text`) with another specified sequence of characters. In this case, we&#x27;re replacing space characters (&#x27; &#x27;) with &#x27;&amp;nbsp;&#x27;<br/>2) Replacing each tab character (&#x27;\t&#x27;) with &#x27;tab_width&#x27; number of &#x27;&amp;nbsp;&#x27;. This is done using Python&#x27;s built-in `&#x27;replace()&#x27;` method again, but instead of a single replacement string, in this case it&#x27;s a repetition of the `&amp;nbsp;` sequence.</td></tr><tr><td>What is the purpose and processing summary of the function: &#x27;combine_json_files&#x27; defined in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;&nbsp;+&nbsp;file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}</td><td>The provided code, specifically `combine_json_files`, is a helper function that is used by another function (`process_data`) to combine multiple JSON files into one final dataset. The main purpose of this function is to take the output from Python&#x27;s automated testing scripts (i.e., JSON files containing information on tests passed and failed), join them together, remove duplicates, and prepare it for training purposes in a machine learning model.<br/><br/>The processing summary includes several operations:<br/>- It reads two separate JSON files (`qa.json` and `instruct.json`) from the specified directory path into Python lists of dictionaries (dictionaries are key-value pairs that contain information about tests).<br/>- Then, it iterates over all other `.json` files in the directory tree using a recursive glob method. For each file found, the data is extended to the combined list. This means all JSON files from different directories and subdirectories will be added to this one large dataset.<br/>- After combining all data into one list, duplicates are removed by converting the entire dictionary of lists (or dicts) into a set, which automatically removes duplicates based on its keys. The resulting values in the final list can be thought of as unique instances.<br/>- Next, if any item in this new dataset starts with &#x27;Purpose of&#x27;, it is kept separate from the rest of the data and written to another file (`instruct_purpose.json`). This is because the original instructions might have some specific details or requirements that are not useful for training purposes (like unique IDs).<br/>- Finally, if HTML conversion is enabled, a helper function `convert_json_to_html` is called which converts all JSON files back into their original form but with different file extensions. The data in these new files can then be used to display the same information as before in an interactive web interface or application.<br/><br/>The purpose of this function and its processing are not immediately apparent from the code, so we&#x27;ll need more context to fully understand it. For instance, is &#x27;combine_json_files&#x27; being called somewhere else in another Python file? If it is, what purpose does that serve? The actual data processed by `combine_json_files` (the combined dataset and potentially other separate datasets) are not immediately clear without additional code snippets or context. Hence, we&#x27;ll need a more complex example to fully grasp the purpose of &#x27;combine_json_files&#x27; with its processing summary.</td></tr><tr><td>What is the purpose and processing summary of the function: &#x27;create_code_graph&#x27; defined in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;graph_type&nbsp;in&nbsp;[&#x27;internal_code_graph&#x27;,&nbsp;&#x27;entire_code_graph&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node_name&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_node(node_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;=&nbsp;edge[&#x27;source&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_inputs&#x27;]&nbsp;=&nbsp;edge[&#x27;target_inputs&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_returns&#x27;]&nbsp;=&nbsp;edge[&#x27;target_returns&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**edge_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size=8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[edge[0],&nbsp;edge[1]]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</td><td>The `create_code_graph` function, which can be found within the provided Python code, serves as a utility for generating visual representations of Python code using networkx and matplotlib libraries. This function is designed to assist with code graph generation operations in the &#x27;py2dataset.save_py2dataset_output&#x27; module.<br/><br/>The purpose of this function is to create visual representations of internal and entire code graphs, which could be used for various purposes, including language model training or understanding processes during AI language modeling. The main processing summary includes:<br/><br/>1) Preparing the necessary data structures from the input `file_details` dictionary. This involves creating a directed graph (using networkx), adding nodes to this graph, and connecting these nodes with edges based on information in &#x27;edges&#x27; list of dictionaries that&#x27;s provided within each value of `&#x27;internal_code_graph&#x27;` or `&#x27;entire_code_graph&#x27;` keys in `file_details[&#x27;file_info&#x27;]`.<br/>2) Applying networkx&#x27;s spring layout algorithm to position the graph. This is done using a call to `nx.spring_layout` function which positions nodes in a circular layout, having good spacing and avoiding overlapping of edges.<br/>3) Finally, using matplotlib library to create a plot of directed graph with labels for each edge as defined within `&#x27;target_inputs&#x27;` and `&#x27;target_returns&#x27;` keys if they exist. The final result is then saved as an image file at the specified output path (`output_subdir / f&#x27;{base_name}.{graph_type}.png&#x27;`).<br/><br/>This function does not perform any actual programming operations, but rather prepares visual representations of Python code to aid in understanding and training language models about Python code.</td></tr><tr><td>What is the purpose and usage of each of these variables: &#x27;file_type&#x27; defined in the function: &#x27;read_file&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;read_file(file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;Dict:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Reads&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file&nbsp;and&nbsp;returns&nbsp;its&nbsp;contents&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Returns:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;the&nbsp;file&nbsp;as&nbsp;a&nbsp;dictionary.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open()&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json.load(f)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;yaml.load(f)</td><td>The context provided does not specify what language model or AI system this code is being used for, which makes it difficult to provide an accurate and comprehensive explanation. However, assuming that we are dealing with a language model trained on Python code, &#x27;file_type&#x27;, &#x27;read_file()&#x27;, and the &#x27;py2dataset.save_py2dataset_output.py&#x27; file are likely variables related to this.<br/><br/>1. The variable &#x27;file_type&#x27; is typically used in programming languages for handling different types of files. In Python, it could be a string representing the extension of the file (e.g., &#x27;.json&#x27;, &#x27;.yaml&#x27;). This is because each language has its own syntax and rules about dealing with various file formats.<br/><br/>2. The function &#x27;read_file&#x27; reads a JSON or YAML file. It&#x27;s important to note that this does not necessarily have to be Python, it could be any programming language. However, the specifics of how to handle these files may vary depending on the language being used and its built-in functionality for handling various types of files.<br/><br/>3. The &#x27;py2dataset.save_py2dataset_output.py&#x27; file is likely a reference to an output file generated by another script in Python. In the context of training a model about Python code, this could refer to a file where an automated program would generate its own dataset and save it somewhere. This data would then be used as input for the language model during training.<br/><br/>So in terms of purpose and usage:<br/>- The variable &#x27;file_type&#x27; is likely being used as a way to differentiate between JSON files and YAML files, which are two common file formats commonly used with configuration files. These could potentially affect how data is loaded into Python dictionaries or other data structures when reading the file.<br/>- The function &#x27;read_file()&#x27; reads in either a JSON or YAML file, depending on what type of file it&#x27;s given as input. This can be important for handling different types of information and formats within these files.<br/>- In the context of training language models about Python code, &#x27;py2dataset.save_py2dataset_output.py&#x27; could refer to a script that generated output data from running in the program. The specifics of how this file is used may vary depending on its use case and the purpose for which it was created.</td></tr><tr><td>What is the purpose and usage of each of these variables: &#x27;file_type&#x27; defined in the function: &#x27;write_file&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;write_file(data:&nbsp;Dict,&nbsp;file_path:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Writes&nbsp;a&nbsp;dictionary&nbsp;to&nbsp;a&nbsp;JSON&nbsp;or&nbsp;YAML&nbsp;file.&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(Dict):&nbsp;The&nbsp;data&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;(Path):&nbsp;The&nbsp;path&nbsp;to&nbsp;the&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_type&nbsp;=&nbsp;file_path.suffix[1:]<br/>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;file_path.open(&#x27;w&#x27;)&nbsp;as&nbsp;f:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_type&nbsp;==&nbsp;&#x27;json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.dump(data,&nbsp;f,&nbsp;indent=4)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;file_type&nbsp;==&nbsp;&#x27;yaml&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.SafeDumper.ignore_aliases&nbsp;=&nbsp;lambda&nbsp;*args:&nbsp;True<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yaml.dump(data,&nbsp;f,&nbsp;Dumper=yaml.SafeDumper,&nbsp;sort_keys=False)</td><td>1) Variable &quot;file_path&quot;:<br/>   - Purpose: The variable &quot;file_path&quot; is being used as an input to the function &#x27;write_file&#x27;. It contains the complete path of a file where data will be written.<br/>   - Usage: Inside the function, it&#x27;s expected that user inputs are provided for this parameter. These inputs can be paths to json and yaml files or any other kind of files depending on what format is required by the program.<br/><br/>2) Variable &quot;data&quot;: <br/>   - Purpose: The variable &#x27;data&#x27; holds all the data which will be written to the file at specified path using &#x27;file_path&#x27;.<br/>   - Usage: This data can be a dictionary, list or any other data structure that needs to be saved in a file. <br/><br/>3) Variable &quot;file_type&quot;: <br/>   - Purpose: The variable &#x27;file_type&#x27; is used as an identifier for the type of file extension. For example, if &#x27;.json&#x27; is provided then it&#x27;s expected json file format. Similarly, if &#x27;.yaml&#x27; is provided then yaml file format will be assumed.<br/>   - Usage: Inside the function, we are checking this variable to decide which serialization method (json or yaml) should be used for writing data in a file. The &#x27;if-elif&#x27; condition check the value of &#x27;file_type&#x27;. If it&#x27;s &#x27;.json&#x27;, we&#x27;ll use json library methods; if it&#x27;s &#x27;.yaml&#x27;, we will use PyYAML module methods.</td></tr><tr><td>What is the purpose and usage of each of these variables: &#x27;dataset, html_content, html_file_path, html_file, value&#x27; defined in the function: &#x27;convert_json_to_html&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;convert_json_to_html(directory:&nbsp;str)&nbsp;-&gt;&nbsp;None:<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;preserve_spacing(text:&nbsp;str,&nbsp;tab_width:&nbsp;int=4)&nbsp;-&gt;&nbsp;str:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Preserve&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;in&nbsp;the&nbsp;provided&nbsp;text.&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;text.replace(&#x27;&nbsp;&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;).replace(&#x27;\t&#x27;,&nbsp;&#x27;&amp;nbsp;&#x27;&nbsp;*&nbsp;tab_width)<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(&#x27;*.json&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(json_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;{border-collapse:&nbsp;collapse;width:&nbsp;100%;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th,&nbsp;td&nbsp;{border:&nbsp;1px&nbsp;solid&nbsp;black;&nbsp;padding:&nbsp;8px;&nbsp;text-align:&nbsp;left;&nbsp;white-space:&nbsp;pre-line;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;td:nth-child(2)&nbsp;{&nbsp;width:&nbsp;50%;&nbsp;overflow-wrap:&nbsp;anywhere;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;dataset[0].keys():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;th&gt;{key}&lt;/th&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;entry:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;escape(str(entry[key]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;key&nbsp;==&nbsp;&#x27;input&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;preserve_spacing(value)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.replace(&#x27;\n&#x27;,&nbsp;&#x27;&lt;br/&gt;&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;f&#x27;&lt;td&gt;{value}&lt;/td&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;&lt;/tr&gt;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_content&nbsp;+=&nbsp;&#x27;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html_file_path&nbsp;=&nbsp;json_file.with_suffix(&#x27;.html&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(html_file_path,&nbsp;&#x27;w&#x27;,&nbsp;encoding=&#x27;utf-8&#x27;)&nbsp;as&nbsp;file:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.write(html_content)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logging.save(logging.info(f&#x27;Failed&nbsp;saving:&nbsp;{html_file_path}&#x27;))</td><td>The purpose and usage of each variable is as follows:<br/>- &#x27;dataset&#x27;: This is a list that contains dictionaries representing data from multiple JSON files. Each dictionary represents an entry or record within those files, with the keys being the column names (or attributes) and the values being the actual data. For example, if we have 5 JSON files each containing different sets of information about books, &#x27;dataset&#x27; would be a list of dictionaries where each dictionary is one book&#x27;s details in its own dictionary.<br/>- &#x27;html_content&#x27;: This is an HTML string that will contain all the processed dataset into HTML table format. The structure and layout of this HTML page are controlled by variables like &#x27;key&#x27;, which represents column names, &#x27;value&#x27;, which contains actual data for each key, etc. For example, if a book has columns &#x27;Title&#x27; and &#x27;Author&#x27;, then html_content would have &#x27;&lt;th&gt;Title&lt;/th&gt;&#x27; and &#x27;&lt;th&gt;Author&lt;/th&gt;&#x27;.<br/>- &#x27;html_file_path&#x27;: This is the full path to where we want to write our HTML file. It&#x27;s typically derived from &#x27;json_file&#x27;. For example, if a JSON file was located at &#x27;/home/user/books/book1.json&#x27;, then html_file_path would be &#x27;/home/user/books/book1.html&#x27;<br/>- &#x27;html_file&#x27;: This is an open file object that points to the HTML file where we will write our processed data. The &#x27;with&#x27; keyword ensures this file is automatically closed after writing, which is good practice as it avoids having a million random files lying around taking up space on your disk.<br/>- &#x27;value&#x27;: These are individual pieces of data from each row in dataset that are being written to the HTML table. They represent actual values for columns in our book records. For instance, if one entry in dataset is {&#x27;Title&#x27;: &#x27;Harry Potter&#x27;, &#x27;Author&#x27;: &#x27;J.K. Rowling&#x27;}, then &#x27;value&#x27; would be &#x27;Harry Potter&#x27; and &#x27;J.K. Rowling&#x27;.<br/><br/>In summary:<br/>- The variable &quot;dataset&quot; is a list of dictionaries that contains all the data from multiple JSON files, represented in HTML format. <br/>- The variables &quot;html_content&quot;, &quot;html_file_path&quot;, and &quot;value&quot; are used to create an HTML file for each JSON file, and it includes details about every book record found therein. <br/>- The variable &quot;html_file&quot; is the open file object that points to the new HTML file where data will be written. This ensures proper closing of the file after writing, which is a good practice to prevent leaking resources.</td></tr><tr><td>What is the purpose and usage of each of these variables: &#x27;dataset, instruct_data, qa_data, file_names, file_path, cleaned_instruct_file_path, seen_inputs, purpose_file_path, combined_data, keys, purpose_data&#x27; defined in the function: &#x27;combine_json_files&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;combine_json_files(directory:&nbsp;str,&nbsp;html:&nbsp;bool)&nbsp;-&gt;&nbsp;Dict[str,&nbsp;List[Dict]]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Combine&nbsp;all&nbsp;JSON&nbsp;files&nbsp;in&nbsp;the&nbsp;output&nbsp;directory&nbsp;into&nbsp;&#x27;qa.json&#x27;&nbsp;and&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&#x27;instruct.json&#x27;,&nbsp;and&nbsp;then&nbsp;remove&nbsp;duplicates.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;(str):&nbsp;The&nbsp;directory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;are&nbsp;located.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;qa.json&#x27;,&nbsp;&#x27;instruct.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;keys&nbsp;=&nbsp;[&#x27;question&#x27;,&nbsp;&#x27;instruction&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;json_file&nbsp;in&nbsp;Path(directory).rglob(f&#x27;*.{file}&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data.extend(read_file(json_file))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;list({i[keys[file_names.index(file)]]:&nbsp;i&nbsp;for&nbsp;i&nbsp;in&nbsp;combined_data}.values())<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(combined_data,&nbsp;file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;qa.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qa_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file&nbsp;==&nbsp;&#x27;instruct.json&#x27;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instruct_data&nbsp;=&nbsp;combined_data.copy()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;combined_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[keys[file_names.index(file)]].startswith(&#x27;Purpose&nbsp;of&#x27;):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_data.append(item)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;purpose_data:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose_file_path&nbsp;=&nbsp;file_path.with_name(file_path.stem&nbsp;+&nbsp;&#x27;_purpose.json&#x27;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(purpose_data,&nbsp;purpose_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combined_data&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_names&nbsp;=&nbsp;[&#x27;instruct.json&#x27;,&nbsp;&#x27;instruct_purpose.json&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;file&nbsp;in&nbsp;file_names:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs&nbsp;=&nbsp;set()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;file<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;file_path.exists():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset&nbsp;=&nbsp;read_file(file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;dataset:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;item[&#x27;input&#x27;]&nbsp;in&nbsp;seen_inputs:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[&#x27;input&#x27;]&nbsp;=&nbsp;&#x27;&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seen_inputs.add(item[&#x27;input&#x27;])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_instruct_file_path&nbsp;=&nbsp;Path(directory)&nbsp;/&nbsp;(&#x27;cleaned_&#x27;&nbsp;+&nbsp;file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_file(dataset,&nbsp;cleaned_instruct_file_path)<br/>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert_json_to_html(directory)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{&#x27;qa_list&#x27;:&nbsp;qa_data,&nbsp;&#x27;instruct_list&#x27;:&nbsp;instruct_data}</td><td>The variables provided are used within a method named &quot;combine_json_files&quot; to clean and combine multiple JSON files into one final dataset, which is then written back to another json file for further processing. Here&#x27;s an explanation of what each variable does:<br/><br/>1. &#x27;dataset&#x27;: This is the list containing all instructions in both &#x27;qa&#x27; and &#x27;instruct&#x27; formats. It gets populated by iterating over &#x27;instruct_data&#x27; (the data from instruct files) with a loop, and then appending these instructions to &#x27;dataset&#x27;.<br/>2. &#x27;instruct_data&#x27;: These are JSON objects representing instructions. Each instruction object has two keys: &quot;instruction&quot; for the actual text of the instruction and &quot;input&quot; which is an array containing all inputs that were given during the execution process (this is also captured in instruct files). <br/>3. &#x27;qa_data&#x27;: This contains data from qa files, where each object represents a question and answer pair. The keys are &#x27;question&#x27; for the actual text of the question and &#x27;answer&#x27; which is an array containing all correct answers to that particular question (this is captured in qa files). <br/>4. &#x27;file_names&#x27;: These are the file names we&#x27;ll use when processing, this includes &quot;qa&quot; and &quot;instruct&quot;.<br/>5. &#x27;file_path&#x27;: This is a Path object representing the path of each file in the directory. It&#x27;s used to read data from these files.<br/>6. &#x27;cleaned_instruct_file_path&#x27;: This is a Path object representing where we&#x27;ll write our cleaned instructions, without any duplicates.<br/>7. &#x27;seen_inputs&#x27;: A set that keeps track of all inputs seen so far while processing the instruct file. If an input has been added to this set once and then comes again, it will be skipped in the final output (to remove duplicate inputs).<br/>8. &#x27;purpose_file_path&#x27;: This is a Path object representing where we&#x27;ll write our purpose data from both qa and instruct files. It&#x27;s only applicable when processing qa or instruct files.<br/>9. &#x27;combined_data&#x27;: A list that will hold the final dataset, which includes all instructions in &quot;qa&quot; format followed by all instructions in &quot;instruct&quot; format (this is due to how we&#x27;ve structured our data). <br/>10. &#x27;keys&#x27;: An array containing two strings representing keys in qa and instruct JSON objects respectively. We&#x27;re using these later to access specific values from each object when processing the dataset.<br/>11. &#x27;purpose_data&#x27;: This is a list that will hold all purpose data, which includes all &quot;Purpose of&quot; instructions found while combining json files. <br/><br/>So overall, we can see that this function is used for cleaning and combining multiple JSON files into one final dataset, mainly to prepare the dataset for further processing in another script (save_py2dataset_output.py). The purpose of each variable is likely due to different purposes or requirements involved with data handling and manipulation as outlined in the provided code.</td></tr><tr><td>What is the purpose and usage of each of these variables: &#x27;label, source, G, edge_data, pos, output_file, target, edge_labels&#x27; defined in the function: &#x27;create_code_graph&#x27; in the Python file: &#x27;py2dataset.save_py2dataset_output.py&#x27;?</td><td>def&nbsp;create_code_graph(file_details:&nbsp;Dict,&nbsp;base_name:&nbsp;str,&nbsp;output_subdir:&nbsp;Path)&nbsp;-&gt;&nbsp;None:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;Generate&nbsp;graphs&nbsp;from&nbsp;the&nbsp;file_details&nbsp;and&nbsp;save&nbsp;them&nbsp;as&nbsp;PNG&nbsp;images.<br/>&nbsp;&nbsp;&nbsp;&nbsp;Args:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_details&nbsp;(dict):&nbsp;The&nbsp;details&nbsp;extracted&nbsp;from&nbsp;the&nbsp;Python&nbsp;file.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_name&nbsp;(str):&nbsp;The&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;output&nbsp;files.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_subdir&nbsp;(Path):&nbsp;The&nbsp;subdirectory&nbsp;where&nbsp;the&nbsp;output&nbsp;files&nbsp;will&nbsp;be<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved.<br/>&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;graph_type&nbsp;in&nbsp;[&#x27;internal_code_graph&#x27;,&nbsp;&#x27;entire_code_graph&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;output_subdir&nbsp;/&nbsp;f&#x27;{base_name}.{graph_type}.png&#x27;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;=&nbsp;nx.DiGraph()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node_name&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;nodes&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_node(node_name)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;file_details[&#x27;file_info&#x27;][graph_type][&#x27;edges&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;=&nbsp;edge[&#x27;source&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;edge[&#x27;target&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;source&nbsp;in&nbsp;G.nodes&nbsp;and&nbsp;target&nbsp;in&nbsp;G.nodes:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_inputs&#x27;]&nbsp;=&nbsp;edge[&#x27;target_inputs&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_data[&#x27;target_returns&#x27;]&nbsp;=&nbsp;edge[&#x27;target_returns&#x27;]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G.add_edge(source,&nbsp;target,&nbsp;**edge_data)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(20,&nbsp;20))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;nx.spring_layout(G)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw(G,&nbsp;pos,&nbsp;with_labels=True,&nbsp;font_weight=&#x27;bold&#x27;,&nbsp;font_size=8,&nbsp;node_shape=&#x27;s&#x27;,&nbsp;node_size=500,&nbsp;width=1,&nbsp;arrowsize=12)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels&nbsp;=&nbsp;{}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;edge&nbsp;in&nbsp;G.edges(data=True):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_inputs&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_inputs&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;Inputs:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_inputs&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#x27;target_returns&#x27;&nbsp;in&nbsp;edge[2]&nbsp;and&nbsp;edge[2][&#x27;target_returns&#x27;]:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label.append(f&quot;\nReturns:&nbsp;{&#x27;,&nbsp;&#x27;.join(edge[2][&#x27;target_returns&#x27;])}&quot;)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edge_labels[edge[0],&nbsp;edge[1]]&nbsp;=&nbsp;&#x27;\n&#x27;.join(label)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx.draw_networkx_edge_labels(G,&nbsp;pos,&nbsp;edge_labels=edge_labels,&nbsp;font_size=6)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.savefig(output_file)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.close()</td><td>The purpose and usage of each of these variables can be briefly explained as follows:<br/><br/>1. label (nx.draw_networkx_edge_labels): This is a function from matplotlib which provides the labels for network edges when plotted using nx.draw(). <br/><br/>2. source, target, G (G = nx.DiGraph()): These are used to create directed graphs in NetworkX package where each &#x27;source&#x27; and &#x27;target&#x27; nodes can be connected with edge_data containing other attributes such as &#x27;target_inputs&#x27; and &#x27;target_returns&#x27;.<br/><br/>3. edge_data: This is a dictionary which contains information about target_inputs and target_returns (if present) for the given source-target node pair in G graph.<br/><br/>4. pos (nx.spring_layout): This function arranges nodes in a circular layout, with the center of the circle at the point (0, 0). <br/><br/>5. output_file: This is the location where we will store and show network graph plot as PNG file using matplotlib&#x27;s plt.savefig().<br/><br/>6. target, edge_labels ((target, G.edges(data=True))) for each in nx.draw_networkx_edge_labels(G, pos): These are used to provide labels on the edges of the directed graph. The &#x27;for&#x27; loop iterates over all pairs of nodes and their corresponding attributes (if any).<br/><br/>In general, these variables are being used to create a detailed network plot showing each file&#x27;s internal code structure as well as entire code structure in a systematic manner for better understanding and analysis purpose. This information can be useful when training models that attempt to predict or analyze such characteristics of Python files, like their complexity, size, etc., thus improving the quality of generated datasets.</td></tr>
                </tbody>
            </table>
        </body>
        </html>
        